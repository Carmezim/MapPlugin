{"version":3,"file":"bundle.js","sources":["../src/maps.js"],"sourcesContent":["export function setGoogleMaps(){\n\taddEventListener('DOMContentLoaded', function () {\n  \tif (document.querySelectorAll('#map').length > 0) {\n    \tconst script      = document.createElement('script');\n      \t    script.type = 'text/javascript';\n        \t  script.src  = 'https://maps.googleapis.com/maps/api/js?key=AIzaSyCR527NNTzbSOMy4D6ZFDLtEfsGl7Z3Q2I&libraries=places&callback=initialize';\n\n    document.body.appendChild(script);\n  \t}\n\t})\n}\n\nexport function initialize() {\n  \n  // measure performance/time to load map \n  const t0 = performance.now();\n\n  // clusterer markers \n  const markers = [];\n\n  // markers svg\n  const Symbol = (id, width, height, fill) => {\n    const marker_svg = {\n      marker: {\n        p: 'M244.31,0C256.87,2.49,269.59,4.38,282,7.58c35.11,9.1,65.15,27.29,90.44,53.07C401.19,90,419.56,125,427,165.51q12.58,68.25-18.92,130.11Q319.47,469.54,230.64,643.36c-.73,1.42-1.59,2.78-2.79,4.87-1.41-2.43-2.5-4.14-3.42-5.93C165.11,526,104.62,410.27,46.93,293.17,8.94,216.08,18.43,141.32,71.6,74c34-43,80.17-66.6,134.87-72.86A44.62,44.62,0,0,0,211.37,0Z',\n        v: '0 0 430.62 648.23'\n      }\n    }\n    return ('data:image/svg+xml;base64,' + window.btoa('<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"' + height + '\" viewBox=\"0 0 430.62 648.23\" width=\"' + width + '\" ><g><path fill=\"' + fill + '\" d=\"' + marker_svg[id].p + '\" /></g></svg>'));\n  }\n\n  // cluster markers style\n  const clusterStyles = [{\n      anchor: [13, 35],\n      textColor: 'white',\n      textSize: '16',\n      url: Symbol('marker', 75, 75, '#f16667'),\n      height: 75,\n      width: 75\n    },\n    {\n      anchor: [20, 42],\n      textColor: 'white',\n      textSize: '18',\n      url: Symbol('marker', 100, 100, '#f16667'),\n      height: 100,\n      width: 100\n    },\n    {\n      anchor: [20, 43.5],\n      textColor: 'white',\n      textSize: '24',\n      url: Symbol('marker', 125, 125, '#f16667'),\n      height: 125,\n      width: 125\n    }\n  ]\n\n  // cluster options\n  const clusterOptions = {\n    imagePath: 'images/m',\n    // needs come closer for marks to appear\n    maxZoom: 15,\n    gridSize: 75,\n    styles: clusterStyles\n  }\n\n  // map center                                \n  const london = new google.maps.LatLng(51.521723, -0.134581);\n\n  // map options\n  const mapOptions = {\n    zoom: 4,\n    center: london,\n    mapTypeId: google.maps.MapTypeId.ROADMAP\n  }\n\n  // map marker\n  const icon = {\n    url: Symbol('marker', 25, 25, '#f16667'),\n  }\n\n  // create map\n  map = new google.maps.Map(document.getElementById(\"map\"), mapOptions);\n    \n  // get json dataset \n  fetch('datasets/coordinates.json')\n    .then((response) => response.json())\n    .then(function(dataset) {\n      // not to confuse 'map' as in array.proptype.map below with an instance of a google map\n      // add locations\n      dataset.map((markerPosition) => {\n        if (!markerPosition.latitude || !markerPosition.longitude) {\n          console.log('meh');\n        }\n        else {\n          let location = new google.maps.LatLng({lat: markerPosition.latitude, lng: markerPosition.longitude});\n\n          const marker = new google.maps.Marker({\n              position: location,\n              map: map,\n              icon: icon\n            });\n          markers.push(marker); \n        }\n      })\n    // create MarkerClusterer\n    const markerCluster = new MarkerClusterer(map, markers, clusterOptions);  \n    })\n    .catch((err) => {\n      if (err) throw err\n    });\n  \n    // Places Search Box\n    // Create search box and link it to UI\n    const input = document.getElementById('pac-input');\n    const searchBox = new google.maps.places.SearchBox(input);\n\n    map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);\n\n    // Bias searchbox results towards current map's viewport\n    map.addListener('bounds_changed', function() {\n      searchBox.setBounds(map.getBounds());\n    });\n\n    let placeMarkers = [];\n\n    searchBox.addListener('places_changed', function() {\n      let places = searchBox.getPlaces();\n\n      if (places.length == 0) {\n        return;\n      }\n\n      // Clear out the old markers.\n      placeMarkers.forEach(function(marker) {\n        marker.setMap(null);\n      });\n      placeMarkers = [];\n\n      // For each place, get the icon, name and location.\n      const bounds = new google.maps.LatLngBounds();\n      places.forEach(function(place) {\n        if (!place.geometry) {\n          console.log(\"Returned place contains no geometry\");\n          return;\n        }\n        const icon = {\n          url: place.icon,\n          size: new google.maps.Size(71, 71),\n          origin: new google.maps.Point(0, 0),\n          anchor: new google.maps.Point(17, 34),\n          scaledSize: new google.maps.Size(25, 25)\n        };\n\n        placeMarkers.push(new google.maps.Marker({\n          map: map,\n          icon: icon,\n          title: place.name,\n          position: place.geometry.location\n        }));\n\n        if (place.geometry.viewport) {\n          // Only geocodes have viewport.\n          bounds.union(place.geometry.viewport);\n        } else {\n          bounds.extend(place.geometry.location);\n        }\n      });\n      map.fitBounds(bounds);\n    });\n\n  const t1 = performance.now();\n  console.log(\"Call to initialize took \" + (t1 - t0) + \" milliseconds.\");\n\n}\n"],"names":["setGoogleMaps","document","querySelectorAll","length","script","createElement","type","src","body","appendChild","initialize","t0","performance","now","markers","Symbol","id","width","height","fill","marker_svg","window","btoa","p","clusterStyles","clusterOptions","london","google","maps","LatLng","mapOptions","MapTypeId","ROADMAP","icon","Map","getElementById","then","response","json","dataset","map","markerPosition","latitude","longitude","log","location","lat","lng","marker","Marker","push","markerCluster","MarkerClusterer","catch","err","input","searchBox","places","SearchBox","controls","ControlPosition","TOP_LEFT","addListener","setBounds","getBounds","placeMarkers","getPlaces","forEach","setMap","bounds","LatLngBounds","place","geometry","Size","Point","name","viewport","union","extend","fitBounds","t1"],"mappings":"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"}