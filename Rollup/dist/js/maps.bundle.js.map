{"version":3,"file":"maps.bundle.js","sources":["../../src/components/searchBox/createSearchBox.js","../../src/components/map/svgMarkers.js","../../src/components/map/mapStyles.js","../../src/components/map/defineCenter.js","../../src/components/map/options.js","../../src/components/searchBox/searchBox.js","../../src/components/promoArea/promoAreaLogged.js","../../src/components/promoArea/promoArea.js","../../node_modules/clusterize.js/clusterize.js","../../src/components/buildList/buildList.js","../../src/components/fetchData/checkData.js","../../src/components/fetchData/getRandom.js","../../src/components/map/markerclusterer.js","../../src/components/characters/iconsList.js","../../src/components/fetchData/fetchData.js","../../src/components/map/createMap.js","../../node_modules/promise-polyfill/promise.js","../../src/polyfills/promise.js","../../node_modules/whatwg-fetch/fetch.js","../../src/components/characters/placeCharacters.js","../../src/components/characters/checkAssetsPath.js","../../src/components/map/map.js"],"sourcesContent":["const $ = window.jQuery;\r\n\r\nconst createSearchBox = (map, mapWrapper) => {\r\n\tlet localMap = map;\r\n\t// Create search box and link it to UI\r\n\tconst $input = $(mapWrapper).find('input.shiftmap-input');\r\n\tconst input = $input.get(0);\r\n\tconst searchBox = new google.maps.places.SearchBox(input);\r\n\treturn searchBox;\r\n};\r\n\r\nexport default createSearchBox;\r\n","// Cluster markers SVG\r\nconst Symbol = (id, width, height, fill) => {\r\n\tconst marker_svg = {\r\n\t\tmarker: {\r\n\t\t\tp: 'M244.31,0C256.87,2.49,269.59,4.38,282,7.58c35.11,9.1,65.15,27.29,90.44,53.07C401.19,90,419.56,125,427,165.51q12.58,68.25-18.92,130.11Q319.47,469.54,230.64,643.36c-.73,1.42-1.59,2.78-2.79,4.87-1.41-2.43-2.5-4.14-3.42-5.93C165.11,526,104.62,410.27,46.93,293.17,8.94,216.08,18.43,141.32,71.6,74c34-43,80.17-66.6,134.87-72.86A44.62,44.62,0,0,0,211.37,0Z',\r\n\t\t\tv: \"0 0 430.62 648.23\"\r\n\t\t}\r\n\t};\r\n\treturn ('data:image/svg+xml;base64,' + window.btoa('<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"' + height + '\" viewBox=\"0 0 430.62 648.23\" width=\"' + width + '\" ><g><path fill=\"' + fill + '\" d=\"' + marker_svg[id].p + '\" /></g></svg>'));\r\n};\r\n\r\nexport default Symbol;","// Map colors\r\nconst land = \"#EEEFF1\";\r\nconst water = \"#71CAF2\";\r\n\r\nconst mapStyles = [\r\n\t\t{\r\n\t\t\t\"elementType\": \"labels\",\r\n\t\t\t\"stylers\": [\r\n\t\t\t\t{\r\n\t\t\t\t\t\"visibility\": \"off\"\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t},\r\n\t\t{\r\n\t\t\t\"featureType\": \"administrative\",\r\n\t\t\t\"elementType\": \"geometry\",\r\n\t\t\t\"stylers\": [\r\n\t\t\t\t{\r\n\t\t\t\t\t\"visibility\": \"off\"\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t},\r\n\t\t{\r\n\t\t\t\"featureType\": \"administrative.land_parcel\",\r\n\t\t\t\"stylers\": [\r\n\t\t\t\t{\r\n\t\t\t\t\t\"visibility\": \"off\"\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t},\r\n\t\t{\r\n\t\t\t\"featureType\": \"administrative.neighborhood\",\r\n\t\t\t\"stylers\": [\r\n\t\t\t\t{\r\n\t\t\t\t\t\"visibility\": \"off\"\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t},\r\n\t\t{\r\n\t\t\t\"featureType\": \"landscape.man_made\",\r\n\t\t\t\"stylers\": [\r\n\t\t\t\t{\r\n\t\t\t\t\t\"color\": land\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t},\r\n\t\t{\r\n\t\t\t\"featureType\": \"landscape.natural\",\r\n\t\t\t\"stylers\": [\r\n\t\t\t\t{\r\n\t\t\t\t\t\"color\": land\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t},\r\n\t\t{\r\n\t\t\t\"featureType\": \"landscape.natural.landcover\",\r\n\t\t\t\"stylers\": [\r\n\t\t\t\t{\r\n\t\t\t\t\t\"color\": land\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t},\r\n\t\t{\r\n\t\t\t\"featureType\": \"landscape.natural.terrain\",\r\n\t\t\t\"stylers\": [\r\n\t\t\t\t{\r\n\t\t\t\t\t\"color\": land\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t},\r\n\t\t{\r\n\t\t\t\"featureType\": \"poi\",\r\n\t\t\t\"stylers\": [\r\n\t\t\t\t{\r\n\t\t\t\t\t\"visibility\": \"off\"\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t},\r\n\t\t{\r\n\t\t\t\"featureType\": \"road\",\r\n\t\t\t\"stylers\": [\r\n\t\t\t\t{\r\n\t\t\t\t\t\"visibility\": \"off\"\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t},\r\n\t\t{\r\n\t\t\t\"featureType\": \"road\",\r\n\t\t\t\"elementType\": \"labels.icon\",\r\n\t\t\t\"stylers\": [\r\n\t\t\t\t{\r\n\t\t\t\t\t\"visibility\": \"off\"\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t},\r\n\t\t{\r\n\t\t\t\"featureType\": \"transit\",\r\n\t\t\t\"stylers\": [\r\n\t\t\t\t{\r\n\t\t\t\t\t\"visibility\": \"off\"\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t},\r\n\t\t{\r\n\t\t\t\"featureType\": \"water\",\r\n\t\t\t\"stylers\": [\r\n\t\t\t\t{\r\n\t\t\t\t\t\"color\": water\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t}\r\n\t];\r\n\r\nexport default mapStyles;\r\n\r\nexport var mapDetailStyles = [\r\n  {\r\n    \"featureType\": \"road.arterial\",\r\n    \"stylers\": [\r\n      {\r\n        \"visibility\": \"off\"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    \"featureType\": \"road.highway\",\r\n    \"elementType\": \"labels\",\r\n    \"stylers\": [\r\n      {\r\n        \"visibility\": \"off\"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    \"featureType\": \"road.local\",\r\n    \"stylers\": [\r\n      {\r\n        \"visibility\": \"off\"\r\n      }\r\n    ]\r\n  },\r\n\t{\r\n\t\t\"featureType\": \"water\",\r\n\t\t\"stylers\": [\r\n\t\t\t{\r\n\t\t\t\t\"color\": water\r\n\t\t\t}\r\n\t\t]\r\n\t},\r\n\t{\r\n\t\t\t\"featureType\": \"landscape.man_made\",\r\n\t\t\t\"stylers\": [\r\n\t\t\t\t{\r\n\t\t\t\t\t\"color\": land\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t},\r\n\t\t{\r\n\t\t\t\"featureType\": \"landscape.natural\",\r\n\t\t\t\"stylers\": [\r\n\t\t\t\t{\r\n\t\t\t\t\t\"color\": land\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t},\r\n\t\t{\r\n\t\t\t\"featureType\": \"landscape.natural.landcover\",\r\n\t\t\t\"stylers\": [\r\n\t\t\t\t{\r\n\t\t\t\t\t\"color\": land\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t},\r\n\t\t{\r\n\t\t\t\"featureType\": \"landscape.natural.terrain\",\r\n\t\t\t\"stylers\": [\r\n\t\t\t\t{\r\n\t\t\t\t\t\"color\": land\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t},\r\n];\r\n","const defineCenter = (lat, lng) =>  new google.maps.LatLng(parseFloat(lat).toFixed(6), parseFloat(lng).toFixed(6));\r\n\r\nexport default defineCenter;\r\n","import Symbol from './svgMarkers';\r\nimport mapStyles from './mapStyles';\r\nimport defineCenter from './defineCenter';\r\n\r\nlet options = {};\r\nlet clusterOptions = {};\r\n\r\n// Map options\r\nconst getMapOptions = () => {\r\n\t$.extend(options, {\r\n\t\tzoom: 3,\r\n\t\tcenter: defineCenter(51.521723, -0.134581),\r\n\t\tmapTypeId: google.maps.MapTypeId.ROADMAP,\r\n\t\tmapTypeControl: false,\r\n\t\tstyles: mapStyles,\r\n\t\tminZoom: 2\r\n\t});\r\n\r\n\treturn options;\r\n}\r\n\r\n// Cluster markers style\r\nconst clusterStyles = [\r\n\t{\r\n\t\tanchor: [17, 35],\r\n\t\ttextColor: 'white',\r\n\t\ttextSize: '16',\r\n\t\turl: './img/icons/icon-2.svg',\r\n\t\theight: 75,\r\n\t\twidth: 75,\r\n\t},\r\n\t{\r\n\t\tanchor: [25, 42],\r\n\t\ttextColor: 'white',\r\n\t\ttextSize: '18',\r\n\t\turl: './img/icons/icon-2.svg',\r\n\t\theight: 100,\r\n\t\twidth: 100,\r\n\t},\r\n\t{\r\n\t\tanchor: [32, 42],\r\n\t\ttextColor: 'white',\r\n\t\ttextSize: '26',\r\n\t\turl: './img/icons/icon-2.svg',\r\n\t\theight: 125,\r\n\t\twidth: 125,\r\n\t},\r\n];\r\n\r\n// Cluster options\r\nconst getClusterOptions = () => {\r\n\t$.extend(clusterOptions, {\r\n\t\tmaxZoom: 12,\r\n\t\tgridSize: 75,\r\n\t\tstyles: clusterStyles,\r\n\t});\r\n\treturn clusterOptions;\r\n}\r\n\r\n// Set new icon\r\nconst setIcon = (newIcon) => {\r\n\treturn newIcon;\r\n};\r\n\r\nconst addCenterToOptions = (center) => {\r\n\toptions.center = center;\r\n};\r\n\r\n// Icon\r\nconst getIcon = () => {\r\n\treturn {\r\n\t\turl: Symbol('marker', 25, 25, '#f16667'),\r\n\t\tsize: new google.maps.Size(71, 71),\r\n\t\torigin: new google.maps.Point(0, 0),\r\n\t\tanchor: new google.maps.Point(17, 34),\r\n\t\tscaledSize: new google.maps.Size(25, 25),\r\n\t};\r\n}\r\n\r\nconst getIconPlace = () => {\r\n\treturn {\r\n\t\turl: Symbol('marker', 50, 50, '#77bf2f'),\r\n\t\tsize: new google.maps.Size(50, 50),\r\n\t\torigin: new google.maps.Point(0, 0),\r\n\t\tanchor: new google.maps.Point(25, 50)\r\n\t}\r\n}\r\n\r\nexport {\r\n\tgetIcon,\r\n\tgetClusterOptions,\r\n\tsetIcon,\r\n\taddCenterToOptions,\r\n\tgetMapOptions,\r\n\tgetIconPlace\r\n};\r\n","import {getIconPlace} from '../map/options';\r\nimport confirmLocationContent from './confirmLocation.html';\r\n\r\nconst searchBox = (map, places, sBox, placeMarkers, getIcon, setIcon) => {\r\n\r\n\t// Bias searchbox results towards current map's viewport\r\n\tmap.addListener('bounds_changed', function() {\r\n\t\tsBox.setBounds(map.getBounds());\r\n\t});\r\n\r\n\t// Listen for the event fired when the user selects a prediction and retrieve\r\n\t// more details for that place.\r\n\tsBox.addListener('places_changed', function() {\r\n\r\n\t\tconst isPlotSearch = $('.shiftmap-promo-area.in').length;\r\n\r\n\t\tplaces = sBox.getPlaces();\r\n\t\tif (places.length == 0) {\r\n\t\t\treturn;\r\n\t\t} else {\r\n\t\t\t// Only one result\r\n\t\t\tplaces = [places[0]];\r\n\t\t}\r\n\r\n\t\t// Clear out the old markers.\r\n\t\tplaceMarkers.forEach(function(marker) {\r\n\t\t\tmarker.setMap(null);\r\n\t\t});\r\n\t\tplaceMarkers = [];\r\n\r\n\t\t// For each place, get the icon, name and location.\r\n\t\tlet bounds = new google.maps.LatLngBounds();\r\n\t\tplaces.forEach(function(place) {\r\n\t\t\tif (!place.geometry) {\r\n\t\t\t\tconsole.log(\"Returned place contains no geometry\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tlet marker;\r\n\r\n\t\t\tif( isPlotSearch ){\r\n\r\n\t\t\t\tmarker = new google.maps.Marker({\r\n\t\t\t\t\tmap: map,\r\n\t\t\t\t\ticon: getIconPlace,\r\n\t\t\t\t\ttitle: place.name,\r\n\t\t\t\t\tposition: place.geometry.location,\r\n\t\t\t\t\toptimized: false,\r\n\t\t\t\t\tzindex: 2,\r\n\t\t\t\t\tclass: 'shiftms-map-cluster-location-icon'\r\n\t\t\t\t});\r\n\r\n\t\t\t\tplaceMarkers.push(marker);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif (place.geometry.viewport) {\r\n\t\t\t\t// Only geocodes have viewport.\r\n\t\t\t\tbounds.union(place.geometry.viewport);\r\n\t\t\t} else {\r\n\t\t\t\tbounds.extend(place.geometry.location);\r\n\t\t\t}\r\n\r\n\t\t\tmap.fitBounds(bounds);\r\n\r\n\t\t\tgoogle.maps.event.addListenerOnce(map, \"idle\", function() { \r\n\t\t\t\tif( isPlotSearch ){\r\n\t\t\t\t\tconst infoWindow = createInfoWindow(map, marker, place);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tgoogle.maps.event.addListenerOnce(map, \"idle\", function() { \r\n\r\n\t\t\t// Disable zoom, as infowindow handles this automatically\r\n\t\t\tif( ! isPlotSearch ){\r\n\t\t\t  map.setZoom(6); \r\n\t\t\t}\r\n\t\t});\r\n\r\n\t});\r\n};\r\nexport default searchBox;\r\n\r\nconst createInfoWindow = ( map, marker, place ) => {\r\n\tconst html = $(confirmLocationContent);\r\n\tvar infowindow = new google.maps.InfoWindow({\r\n      content: ''\r\n    });\r\n\r\n    infowindow.setContent(html.get(0));\r\n\r\n\thtml.find(\"button\").click(() => {\r\n\t\tgoogle.maps.event.trigger(map, 'shiftms_plotted_location', place, marker);\r\n\t\tinfowindow.close();\r\n\t\t$('html').removeClass('map-plotting-active');\r\n\t\t$('.shiftmap-promo-area').removeClass('in');\r\n\t});\r\n\r\n\tinfowindow.open(map, marker);\r\n    \r\n    return infowindow;\r\n}","import promoHtml from './promoAreaLogged.html';\r\n\r\nconst promoArea = (insertMarker, assetsPath) => {\r\n\tlet html = promoHtml;\r\n\thtml = $(promoHtml.replace('%assetspath%', assetsPath));\r\n\r\n\tconst userPanel = $('.shiftmap-map-clusterise-wrapper');\r\n\tuserPanel.prepend(html);\r\n\thtml.find('button').click(insertMarker).click(() => {\r\n\t\thtml.addClass('in');\r\n\t\t$('html').addClass('map-plotting-active');\r\n\t\tconst input = userPanel.find(\"input.shiftmap-input\").one('blur', () => {\r\n\t\t});\t\r\n\t\tsetTimeout(() => {\r\n\t\t\tinput.focus();\r\n\t\t}, 100 );\r\n\t});\r\n\r\n\thtml.find('a').click(() => {\r\n\t\thtml.removeClass('in');\r\n\t\t$('html').removeClass('map-plotting-active');\r\n\t});\r\n};\r\n\r\nexport default promoArea;","import promoHtml from './promoArea.html';\r\n\r\nconst promoArea = (insertMarker, numUsers, assetsPath) => {\r\n\tlet html = promoHtml;\r\n\thtml = $(promoHtml.replace('%total%', numUsers)\t\r\n\t\t.replace('%assetspath%', assetsPath));\r\n\r\n\tconst userPanel = $('.shiftmap-map-clusterise-wrapper');\r\n\tuserPanel.prepend(html);\r\n\thtml.find('button').click(insertMarker).click(() => {\r\n\t\thtml.addClass('in');\r\n\t\t$('html').addClass('map-plotting-active');\r\n\t\tconst input = userPanel.find(\"input.shiftmap-input\").one('blur', () => {\r\n\t\t\t// setTimeout(() => html.removeClass('in'), 500 );\r\n\t\t});\t\r\n\t\tsetTimeout(() => {\r\n\t\t\tinput.focus();\r\n\t\t}, 100 );\r\n\t});\r\n\r\n\thtml.find('a').click(() => {\r\n\t\thtml.removeClass('in');\r\n\t\t$('html').removeClass('map-plotting-active');\r\n\t});\r\n};\r\n\r\nexport default promoArea;","/*! Clusterize.js - v0.17.6 - 2017-03-05\n* http://NeXTs.github.com/Clusterize.js/\n* Copyright (c) 2015 Denis Lukov; Licensed GPLv3 */\n\n;(function(name, definition) {\n    if (typeof module != 'undefined') module.exports = definition();\n    else if (typeof define == 'function' && typeof define.amd == 'object') define(definition);\n    else this[name] = definition();\n}('Clusterize', function() {\n  \"use strict\"\n\n  // detect ie9 and lower\n  // https://gist.github.com/padolsey/527683#comment-786682\n  var ie = (function(){\n    for( var v = 3,\n             el = document.createElement('b'),\n             all = el.all || [];\n         el.innerHTML = '<!--[if gt IE ' + (++v) + ']><i><![endif]-->',\n         all[0];\n       ){}\n    return v > 4 ? v : document.documentMode;\n  }()),\n  is_mac = navigator.platform.toLowerCase().indexOf('mac') + 1;\n  var Clusterize = function(data) {\n    if( ! (this instanceof Clusterize))\n      return new Clusterize(data);\n    var self = this;\n\n    var defaults = {\n      rows_in_block: 50,\n      blocks_in_cluster: 4,\n      tag: null,\n      show_no_data_row: true,\n      no_data_class: 'clusterize-no-data',\n      no_data_text: 'No data',\n      keep_parity: true,\n      callbacks: {}\n    }\n\n    // public parameters\n    self.options = {};\n    var options = ['rows_in_block', 'blocks_in_cluster', 'show_no_data_row', 'no_data_class', 'no_data_text', 'keep_parity', 'tag', 'callbacks'];\n    for(var i = 0, option; option = options[i]; i++) {\n      self.options[option] = typeof data[option] != 'undefined' && data[option] != null\n        ? data[option]\n        : defaults[option];\n    }\n\n    var elems = ['scroll', 'content'];\n    for(var i = 0, elem; elem = elems[i]; i++) {\n      self[elem + '_elem'] = data[elem + 'Id']\n        ? document.getElementById(data[elem + 'Id'])\n        : data[elem + 'Elem'];\n      if( ! self[elem + '_elem'])\n        throw new Error(\"Error! Could not find \" + elem + \" element\");\n    }\n\n    // tabindex forces the browser to keep focus on the scrolling list, fixes #11\n    if( ! self.content_elem.hasAttribute('tabindex'))\n      self.content_elem.setAttribute('tabindex', 0);\n\n    // private parameters\n    var rows = isArray(data.rows)\n        ? data.rows\n        : self.fetchMarkup(),\n      cache = {},\n      scroll_top = self.scroll_elem.scrollTop;\n\n    // append initial data\n    self.insertToDOM(rows, cache);\n\n    // restore the scroll position\n    self.scroll_elem.scrollTop = scroll_top;\n\n    // adding scroll handler\n    var last_cluster = false,\n    scroll_debounce = 0,\n    pointer_events_set = false,\n    scrollEv = function() {\n      // fixes scrolling issue on Mac #3\n      if (is_mac) {\n          if( ! pointer_events_set) self.content_elem.style.pointerEvents = 'none';\n          pointer_events_set = true;\n          clearTimeout(scroll_debounce);\n          scroll_debounce = setTimeout(function () {\n              self.content_elem.style.pointerEvents = 'auto';\n              pointer_events_set = false;\n          }, 50);\n      }\n      if (last_cluster != (last_cluster = self.getClusterNum()))\n        self.insertToDOM(rows, cache);\n      if (self.options.callbacks.scrollingProgress)\n        self.options.callbacks.scrollingProgress(self.getScrollProgress());\n    },\n    resize_debounce = 0,\n    resizeEv = function() {\n      clearTimeout(resize_debounce);\n      resize_debounce = setTimeout(self.refresh, 100);\n    }\n    on('scroll', self.scroll_elem, scrollEv);\n    on('resize', window, resizeEv);\n\n    // public methods\n    self.destroy = function(clean) {\n      off('scroll', self.scroll_elem, scrollEv);\n      off('resize', window, resizeEv);\n      self.html((clean ? self.generateEmptyRow() : rows).join(''));\n    }\n    self.refresh = function(force) {\n      if(self.getRowsHeight(rows) || force) self.update(rows);\n    }\n    self.update = function(new_rows) {\n      rows = isArray(new_rows)\n        ? new_rows\n        : [];\n      var scroll_top = self.scroll_elem.scrollTop;\n      // fixes #39\n      if(rows.length * self.options.item_height < scroll_top) {\n        self.scroll_elem.scrollTop = 0;\n        last_cluster = 0;\n      }\n      self.insertToDOM(rows, cache);\n      self.scroll_elem.scrollTop = scroll_top;\n    }\n    self.clear = function() {\n      self.update([]);\n    }\n    self.getRowsAmount = function() {\n      return rows.length;\n    }\n    self.getScrollProgress = function() {\n      return this.options.scroll_top / (rows.length * this.options.item_height) * 100 || 0;\n    }\n\n    var add = function(where, _new_rows) {\n      var new_rows = isArray(_new_rows)\n        ? _new_rows\n        : [];\n      if( ! new_rows.length) return;\n      rows = where == 'append'\n        ? rows.concat(new_rows)\n        : new_rows.concat(rows);\n      self.insertToDOM(rows, cache);\n    }\n    self.append = function(rows) {\n      add('append', rows);\n    }\n    self.prepend = function(rows) {\n      add('prepend', rows);\n    }\n  }\n\n  Clusterize.prototype = {\n    constructor: Clusterize,\n    // fetch existing markup\n    fetchMarkup: function() {\n      var rows = [], rows_nodes = this.getChildNodes(this.content_elem);\n      while (rows_nodes.length) {\n        rows.push(rows_nodes.shift().outerHTML);\n      }\n      return rows;\n    },\n    // get tag name, content tag name, tag height, calc cluster height\n    exploreEnvironment: function(rows, cache) {\n      var opts = this.options;\n      opts.content_tag = this.content_elem.tagName.toLowerCase();\n      if( ! rows.length) return;\n      if(ie && ie <= 9 && ! opts.tag) opts.tag = rows[0].match(/<([^>\\s/]*)/)[1].toLowerCase();\n      if(this.content_elem.children.length <= 1) cache.data = this.html(rows[0] + rows[0] + rows[0]);\n      if( ! opts.tag) opts.tag = this.content_elem.children[0].tagName.toLowerCase();\n      this.getRowsHeight(rows);\n    },\n    getRowsHeight: function(rows) {\n      var opts = this.options,\n        prev_item_height = opts.item_height;\n      opts.cluster_height = 0;\n      if( ! rows.length) return;\n      var nodes = this.content_elem.children;\n      var node = nodes[Math.floor(nodes.length / 2)];\n      opts.item_height = node.offsetHeight;\n      // consider table's border-spacing\n      if(opts.tag == 'tr' && getStyle('borderCollapse', this.content_elem) != 'collapse')\n        opts.item_height += parseInt(getStyle('borderSpacing', this.content_elem), 10) || 0;\n      // consider margins (and margins collapsing)\n      if(opts.tag != 'tr') {\n        var marginTop = parseInt(getStyle('marginTop', node), 10) || 0;\n        var marginBottom = parseInt(getStyle('marginBottom', node), 10) || 0;\n        opts.item_height += Math.max(marginTop, marginBottom);\n      }\n      opts.block_height = opts.item_height * opts.rows_in_block;\n      opts.rows_in_cluster = opts.blocks_in_cluster * opts.rows_in_block;\n      opts.cluster_height = opts.blocks_in_cluster * opts.block_height;\n      return prev_item_height != opts.item_height;\n    },\n    // get current cluster number\n    getClusterNum: function () {\n      this.options.scroll_top = this.scroll_elem.scrollTop;\n      return Math.floor(this.options.scroll_top / (this.options.cluster_height - this.options.block_height)) || 0;\n    },\n    // generate empty row if no data provided\n    generateEmptyRow: function() {\n      var opts = this.options;\n      if( ! opts.tag || ! opts.show_no_data_row) return [];\n      var empty_row = document.createElement(opts.tag),\n        no_data_content = document.createTextNode(opts.no_data_text), td;\n      empty_row.className = opts.no_data_class;\n      if(opts.tag == 'tr') {\n        td = document.createElement('td');\n        // fixes #53\n        td.colSpan = 100;\n        td.appendChild(no_data_content);\n      }\n      empty_row.appendChild(td || no_data_content);\n      return [empty_row.outerHTML];\n    },\n    // generate cluster for current scroll position\n    generate: function (rows, cluster_num) {\n      var opts = this.options,\n        rows_len = rows.length;\n      if (rows_len < opts.rows_in_block) {\n        return {\n          top_offset: 0,\n          bottom_offset: 0,\n          rows_above: 0,\n          rows: rows_len ? rows : this.generateEmptyRow()\n        }\n      }\n      var items_start = Math.max((opts.rows_in_cluster - opts.rows_in_block) * cluster_num, 0),\n        items_end = items_start + opts.rows_in_cluster,\n        top_offset = Math.max(items_start * opts.item_height, 0),\n        bottom_offset = Math.max((rows_len - items_end) * opts.item_height, 0),\n        this_cluster_rows = [],\n        rows_above = items_start;\n      if(top_offset < 1) {\n        rows_above++;\n      }\n      for (var i = items_start; i < items_end; i++) {\n        rows[i] && this_cluster_rows.push(rows[i]);\n      }\n      return {\n        top_offset: top_offset,\n        bottom_offset: bottom_offset,\n        rows_above: rows_above,\n        rows: this_cluster_rows\n      }\n    },\n    renderExtraTag: function(class_name, height) {\n      var tag = document.createElement(this.options.tag),\n        clusterize_prefix = 'clusterize-';\n      tag.className = [clusterize_prefix + 'extra-row', clusterize_prefix + class_name].join(' ');\n      height && (tag.style.height = height + 'px');\n      return tag.outerHTML;\n    },\n    // if necessary verify data changed and insert to DOM\n    insertToDOM: function(rows, cache) {\n      // explore row's height\n      if( ! this.options.cluster_height) {\n        this.exploreEnvironment(rows, cache);\n      }\n      var data = this.generate(rows, this.getClusterNum()),\n        this_cluster_rows = data.rows.join(''),\n        this_cluster_content_changed = this.checkChanges('data', this_cluster_rows, cache),\n        top_offset_changed = this.checkChanges('top', data.top_offset, cache),\n        only_bottom_offset_changed = this.checkChanges('bottom', data.bottom_offset, cache),\n        callbacks = this.options.callbacks,\n        layout = [];\n\n      if(this_cluster_content_changed || top_offset_changed) {\n        if(data.top_offset) {\n          this.options.keep_parity && layout.push(this.renderExtraTag('keep-parity'));\n          layout.push(this.renderExtraTag('top-space', data.top_offset));\n        }\n        layout.push(this_cluster_rows);\n        data.bottom_offset && layout.push(this.renderExtraTag('bottom-space', data.bottom_offset));\n        callbacks.clusterWillChange && callbacks.clusterWillChange();\n        this.html(layout.join(''));\n        this.options.content_tag == 'ol' && this.content_elem.setAttribute('start', data.rows_above);\n        callbacks.clusterChanged && callbacks.clusterChanged();\n      } else if(only_bottom_offset_changed) {\n        this.content_elem.lastChild.style.height = data.bottom_offset + 'px';\n      }\n    },\n    // unfortunately ie <= 9 does not allow to use innerHTML for table elements, so make a workaround\n    html: function(data) {\n      var content_elem = this.content_elem;\n      if(ie && ie <= 9 && this.options.tag == 'tr') {\n        var div = document.createElement('div'), last;\n        div.innerHTML = '<table><tbody>' + data + '</tbody></table>';\n        while((last = content_elem.lastChild)) {\n          content_elem.removeChild(last);\n        }\n        var rows_nodes = this.getChildNodes(div.firstChild.firstChild);\n        while (rows_nodes.length) {\n          content_elem.appendChild(rows_nodes.shift());\n        }\n      } else {\n        content_elem.innerHTML = data;\n      }\n    },\n    getChildNodes: function(tag) {\n        var child_nodes = tag.children, nodes = [];\n        for (var i = 0, ii = child_nodes.length; i < ii; i++) {\n            nodes.push(child_nodes[i]);\n        }\n        return nodes;\n    },\n    checkChanges: function(type, value, cache) {\n      var changed = value != cache[type];\n      cache[type] = value;\n      return changed;\n    }\n  }\n\n  // support functions\n  function on(evt, element, fnc) {\n    return element.addEventListener ? element.addEventListener(evt, fnc, false) : element.attachEvent(\"on\" + evt, fnc);\n  }\n  function off(evt, element, fnc) {\n    return element.removeEventListener ? element.removeEventListener(evt, fnc, false) : element.detachEvent(\"on\" + evt, fnc);\n  }\n  function isArray(arr) {\n    return Object.prototype.toString.call(arr) === '[object Array]';\n  }\n  function getStyle(prop, elem) {\n    return window.getComputedStyle ? window.getComputedStyle(elem)[prop] : elem.currentStyle[prop];\n  }\n\n  return Clusterize;\n}));","let zoomingOnSingle = false;\r\nconst buildList = (clusterize, listArray, markers, localMap, domElement) => {\r\n\r\n\tif( zoomingOnSingle ){\r\n\t\treturn;\r\n\t}\r\n\r\n\tlistArray = [];\r\n\tclusterize.clear();\r\n\r\n\tmarkers.map((user) => {\r\n\t\tif (localMap.getBounds().contains(user.getPosition())) {\r\n\t\t\tlistArray.push(\r\n\t\t\t`<div class=\"shiftmap-clusterize-user-row shiftmap-clusterize-user-row-${user.userID}\">\r\n\t\t\t\t<div class=\"shiftmap-clusterize-user-cell\">\r\n\t\t\t\t\t<div class=\"shiftmap-clusterize-avatar\">\r\n\t\t\t\t\t\t<div style=\"background-image:url('${user.url}')\"></div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"shiftmap-clusterize-content\">\r\n\t\t\t\t\t\t<h3 class=\"shiftmap-clusterize-user-name\">${user.userName}</h3>\r\n\t\t\t\t\t\t<div class=\"active\">Last active 2 weeks ago</div>\r\n\t\t\t\t\t\t<button class=\"shiftmap-clusterize-user-button\" data-clickuser=\"${user.userID}\">Follow</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>`\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\t// Dsiplay user info on sidebar \r\n\t\tconst showUserInfo = () => {\r\n\t\t\t$(domElement).trigger('openpanel');\r\n\t\t\tclusterize.clear();\r\n\t\t\tclusterize.update([\r\n\t\t\t\t`\r\n\t\t\t\t<div class=\"shiftmap-clusterize-user-row shiftmap-clusterize-user-row-single\">\r\n\t\t\t\t\t<div class=\"shiftmap-clusterize-user-cell\">\r\n\t\t\t\t\t\t<div class=\"shiftmap-clusterize-avatar\">\r\n\t\t\t\t\t\t\t<div style=\"background-image:url('${user.url}')\"></div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"shiftmap-clusterize-content\">\r\n\t\t\t\t\t\t\t <div class=\"visible\"><span data-clickuser=\"${user.userID}\">User:</span> ${user.userName}</div>\r\n\t\t\t\t\t\t\t <div class=\"${user.city && 'visible'}\"><span>City:</span> ${user.city}</div>\r\n\t\t\t\t\t\t\t <div class=\"${user.country && 'visible'}\"><span>Country:</span> ${user.country}</div>\r\n\t\t\t\t\t\t\t <div class=\"${(user.active||true) && 'visible active'}\">Last active 2 weeks ago</div>\r\n\t\t\t\t\t\t\t <div class=\"visible\">\r\n\t\t\t\t\t\t\t \t<button class=\"shiftmap-clusterize-user-button\" data-clickuser=\"${user.userID}\">Follow</button>\r\n\t\t\t\t\t\t\t </div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t`\r\n\t\t\t]);\r\n\t\t\tclusterize.refresh();\r\n\t\t};\r\n\t\t\r\n\t\t// On marker clikc user info is displayed\r\n\t\tif( !user.clickEventBound ){\r\n\t\t\tgoogle.maps.event.addDomListener(user, 'click', () => {\r\n\t\t\t\tzoomingOnSingle = true;\r\n\t\t\t\tshowUserInfo();\r\n\r\n\t\t\t\tif(localMap.getZoom() < 8 ){\r\n\t\t\t\t\tlocalMap.setZoom(8);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlocalMap.setCenter(user.getPosition());\r\n\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tzoomingOnSingle = false;\r\n\t\t\t\t}, 1000 );\r\n\r\n\t\t\t});\r\n\t\t\tuser.clickEventBound = true;\r\n\t\t}\r\n\r\n\t});\r\n\r\n\tclusterize.update(listArray);\r\n\tclusterize.refresh();\r\n};\r\nexport default buildList;","const checkData = (dataset) => {\r\n\ttry {\r\n\t\tJSON.stringify(dataset);\r\n\t\treturn true;\r\n\t}\r\n\tcatch(err) {\r\n\t\tconsole.error('Data is not JSON format!');\r\n\t\treturn false;\r\n\t}\r\n};\r\nexport default checkData;","// Generate random numbers between a min and a max values\r\nconst getRandom = (min, max) => {\r\n\treturn Math.random() * (max - min) + min;\r\n};\r\n\r\nexport default getRandom;","// ==ClosureCompiler==\r\n// @compilation_level ADVANCED_OPTIMIZATIONS\r\n// @externs_url http://closure-compiler.googlecode.com/svn/trunk/contrib/externs/maps/google_maps_api_v3_3.js\r\n// ==/ClosureCompiler==\r\n\r\n/**\r\n * @name MarkerClusterer for Google Maps v3\r\n * @version version 1.0.1\r\n * @author Luke Mahe\r\n * @fileoverview\r\n * The library creates and manages per-zoom-level clusters for large amounts of\r\n * markers.\r\n * <br/>\r\n * This is a v3 implementation of the\r\n * <a href=\"http://gmaps-utility-library-dev.googlecode.com/svn/tags/markerclusterer/\"\r\n * >v2 MarkerClusterer</a>.\r\n */\r\n\r\n/**\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\n\r\n/**\r\n * A Marker Clusterer that clusters markers.\r\n *\r\n * @param {google.maps.Map} map The Google map to attach to.\r\n * @param {Array.<google.maps.Marker>=} opt_markers Optional markers to add to\r\n *   the cluster.\r\n * @param {Object=} opt_options support the following options:\r\n *     'gridSize': (number) The grid size of a cluster in pixels.\r\n *     'maxZoom': (number) The maximum zoom level that a marker can be part of a\r\n *                cluster.\r\n *     'zoomOnClick': (boolean) Whether the default behaviour of clicking on a\r\n *                    cluster is to zoom into it.\r\n *     'imagePath': (string) The base URL where the images representing\r\n *                  clusters will be found. The full URL will be:\r\n *                  {imagePath}[1-5].{imageExtension}\r\n *                  Default: '../images/m'.\r\n *     'imageExtension': (string) The suffix for images URL representing\r\n *                       clusters will be found. See _imagePath_ for details.\r\n *                       Default: 'png'.\r\n *     'averageCenter': (boolean) Whether the center of each cluster should be\r\n *                      the average of all markers in the cluster.\r\n *     'minimumClusterSize': (number) The minimum number of markers to be in a\r\n *                           cluster before the markers are hidden and a count\r\n *                           is shown.\r\n *     'styles': (object) An object that has style properties:\r\n *       'url': (string) The image url.\r\n *       'height': (number) The image height.\r\n *       'width': (number) The image width.\r\n *       'anchor': (Array) The anchor position of the label text.\r\n *       'textColor': (string) The text color.\r\n *       'textSize': (number) The text size.\r\n *       'backgroundPosition': (string) The position of the backgound x, y.\r\n * @constructor\r\n * @extends google.maps.OverlayView\r\n */\r\nfunction MarkerClusterer(map, opt_markers, opt_options) {\r\n  // MarkerClusterer implements google.maps.OverlayView interface. We use the\r\n  // extend function to extend MarkerClusterer with google.maps.OverlayView\r\n  // because it might not always be available when the code is defined so we\r\n  // look for it at the last possible moment. If it doesn't exist now then\r\n  // there is no point going ahead :)\r\n  this.extend(MarkerClusterer, google.maps.OverlayView);\r\n  this.map_ = map;\r\n\r\n  /**\r\n   * @type {Array.<google.maps.Marker>}\r\n   * @private\r\n   */\r\n  this.markers_ = [];\r\n\r\n  /**\r\n   *  @type {Array.<Cluster>}\r\n   */\r\n  this.clusters_ = [];\r\n\r\n  this.sizes = [53, 56, 66, 78, 90];\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  this.styles_ = [];\r\n\r\n  /**\r\n   * @type {boolean}\r\n   * @private\r\n   */\r\n  this.ready_ = false;\r\n\r\n  var options = opt_options || {};\r\n\r\n  /**\r\n   * @type {number}\r\n   * @private\r\n   */\r\n  this.gridSize_ = options['gridSize'] || 60;\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  this.minClusterSize_ = options['minimumClusterSize'] || 2;\r\n\r\n\r\n  /**\r\n   * @type {?number}\r\n   * @private\r\n   */\r\n  this.maxZoom_ = options['maxZoom'] || null;\r\n\r\n  this.styles_ = options['styles'] || [];\r\n\r\n  /**\r\n   * @type {string}\r\n   * @private\r\n   */\r\n  this.imagePath_ = options['imagePath'] ||\r\n      this.MARKER_CLUSTER_IMAGE_PATH_;\r\n\r\n  /**\r\n   * @type {string}\r\n   * @private\r\n   */\r\n  this.imageExtension_ = options['imageExtension'] ||\r\n      this.MARKER_CLUSTER_IMAGE_EXTENSION_;\r\n\r\n  /**\r\n   * @type {boolean}\r\n   * @private\r\n   */\r\n  this.zoomOnClick_ = true;\r\n\r\n  if (options['zoomOnClick'] != undefined) {\r\n    this.zoomOnClick_ = options['zoomOnClick'];\r\n  }\r\n\r\n  /**\r\n   * @type {boolean}\r\n   * @private\r\n   */\r\n  this.averageCenter_ = false;\r\n\r\n  if (options['averageCenter'] != undefined) {\r\n    this.averageCenter_ = options['averageCenter'];\r\n  }\r\n\r\n  this.setupStyles_();\r\n\r\n  this.setMap(map);\r\n\r\n  /**\r\n   * @type {number}\r\n   * @private\r\n   */\r\n  this.prevZoom_ = this.map_.getZoom();\r\n\r\n  // Add the map event listeners\r\n  var that = this;\r\n  google.maps.event.addListener(this.map_, 'zoom_changed', function() {\r\n    // Determines map type and prevent illegal zoom levels\r\n    var zoom = that.map_.getZoom();\r\n    var minZoom = that.map_.minZoom || 0;\r\n    var maxZoom = Math.min(that.map_.maxZoom || 100,\r\n                         that.map_.mapTypes[that.map_.getMapTypeId()].maxZoom);\r\n    zoom = Math.min(Math.max(zoom,minZoom),maxZoom);\r\n\r\n    if (that.prevZoom_ != zoom) {\r\n      that.prevZoom_ = zoom;\r\n      that.resetViewport();\r\n    }\r\n  });\r\n\r\n  google.maps.event.addListener(this.map_, 'idle', function() {\r\n    that.redraw();\r\n  });\r\n\r\n  // Finally, add the markers\r\n  if (opt_markers && (opt_markers.length || Object.keys(opt_markers).length)) {\r\n    this.addMarkers(opt_markers, false);\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * The marker cluster image path.\r\n *\r\n * @type {string}\r\n * @private\r\n */\r\nMarkerClusterer.prototype.MARKER_CLUSTER_IMAGE_PATH_ = '../images/m';\r\n\r\n\r\n/**\r\n * The marker cluster image path.\r\n *\r\n * @type {string}\r\n * @private\r\n */\r\nMarkerClusterer.prototype.MARKER_CLUSTER_IMAGE_EXTENSION_ = 'png';\r\n\r\n\r\n/**\r\n * Extends a objects prototype by anothers.\r\n *\r\n * @param {Object} obj1 The object to be extended.\r\n * @param {Object} obj2 The object to extend with.\r\n * @return {Object} The new extended object.\r\n * @ignore\r\n */\r\nMarkerClusterer.prototype.extend = function(obj1, obj2) {\r\n  return (function(object) {\r\n    for (var property in object.prototype) {\r\n      this.prototype[property] = object.prototype[property];\r\n    }\r\n    return this;\r\n  }).apply(obj1, [obj2]);\r\n};\r\n\r\n\r\n/**\r\n * Implementaion of the interface method.\r\n * @ignore\r\n */\r\nMarkerClusterer.prototype.onAdd = function() {\r\n  this.setReady_(true);\r\n};\r\n\r\n/**\r\n * Implementaion of the interface method.\r\n * @ignore\r\n */\r\nMarkerClusterer.prototype.draw = function() {};\r\n\r\n/**\r\n * Sets up the styles object.\r\n *\r\n * @private\r\n */\r\nMarkerClusterer.prototype.setupStyles_ = function() {\r\n  if (this.styles_.length) {\r\n    return;\r\n  }\r\n\r\n  for (var i = 0, size; size = this.sizes[i]; i++) {\r\n    this.styles_.push({\r\n      url: this.imagePath_ + (i + 1) + '.' + this.imageExtension_,\r\n      height: size,\r\n      width: size\r\n    });\r\n  }\r\n};\r\n\r\n/**\r\n *  Fit the map to the bounds of the markers in the clusterer.\r\n */\r\nMarkerClusterer.prototype.fitMapToMarkers = function() {\r\n  var markers = this.getMarkers();\r\n  var bounds = new google.maps.LatLngBounds();\r\n  for (var i = 0, marker; marker = markers[i]; i++) {\r\n    bounds.extend(marker.getPosition());\r\n  }\r\n\r\n  this.map_.fitBounds(bounds);\r\n};\r\n\r\n\r\n/**\r\n *  Sets the styles.\r\n *\r\n *  @param {Object} styles The style to set.\r\n */\r\nMarkerClusterer.prototype.setStyles = function(styles) {\r\n  this.styles_ = styles;\r\n};\r\n\r\n\r\n/**\r\n *  Gets the styles.\r\n *\r\n *  @return {Object} The styles object.\r\n */\r\nMarkerClusterer.prototype.getStyles = function() {\r\n  return this.styles_;\r\n};\r\n\r\n\r\n/**\r\n * Whether zoom on click is set.\r\n *\r\n * @return {boolean} True if zoomOnClick_ is set.\r\n */\r\nMarkerClusterer.prototype.isZoomOnClick = function() {\r\n  return this.zoomOnClick_;\r\n};\r\n\r\n/**\r\n * Whether average center is set.\r\n *\r\n * @return {boolean} True if averageCenter_ is set.\r\n */\r\nMarkerClusterer.prototype.isAverageCenter = function() {\r\n  return this.averageCenter_;\r\n};\r\n\r\n\r\n/**\r\n *  Returns the array of markers in the clusterer.\r\n *\r\n *  @return {Array.<google.maps.Marker>} The markers.\r\n */\r\nMarkerClusterer.prototype.getMarkers = function() {\r\n  return this.markers_;\r\n};\r\n\r\n\r\n/**\r\n *  Returns the number of markers in the clusterer\r\n *\r\n *  @return {Number} The number of markers.\r\n */\r\nMarkerClusterer.prototype.getTotalMarkers = function() {\r\n  return this.markers_.length;\r\n};\r\n\r\n\r\n/**\r\n *  Sets the max zoom for the clusterer.\r\n *\r\n *  @param {number} maxZoom The max zoom level.\r\n */\r\nMarkerClusterer.prototype.setMaxZoom = function(maxZoom) {\r\n  this.maxZoom_ = maxZoom;\r\n};\r\n\r\n\r\n/**\r\n *  Gets the max zoom for the clusterer.\r\n *\r\n *  @return {number} The max zoom level.\r\n */\r\nMarkerClusterer.prototype.getMaxZoom = function() {\r\n  return this.maxZoom_;\r\n};\r\n\r\n\r\n/**\r\n *  The function for calculating the cluster icon image.\r\n *\r\n *  @param {Array.<google.maps.Marker>} markers The markers in the clusterer.\r\n *  @param {number} numStyles The number of styles available.\r\n *  @return {Object} A object properties: 'text' (string) and 'index' (number).\r\n *  @private\r\n */\r\nMarkerClusterer.prototype.calculator_ = function(markers, numStyles) {\r\n  var index = 0;\r\n  var count = markers.length;\r\n  var dv = count;\r\n  while (dv !== 0) {\r\n    dv = parseInt(dv / 10, 10);\r\n    index++;\r\n  }\r\n\r\n  index = Math.min(index, numStyles);\r\n  return {\r\n    text: count,\r\n    index: index\r\n  };\r\n};\r\n\r\n\r\n/**\r\n * Set the calculator function.\r\n *\r\n * @param {function(Array, number)} calculator The function to set as the\r\n *     calculator. The function should return a object properties:\r\n *     'text' (string) and 'index' (number).\r\n *\r\n */\r\nMarkerClusterer.prototype.setCalculator = function(calculator) {\r\n  this.calculator_ = calculator;\r\n};\r\n\r\n\r\n/**\r\n * Get the calculator function.\r\n *\r\n * @return {function(Array, number)} the calculator function.\r\n */\r\nMarkerClusterer.prototype.getCalculator = function() {\r\n  return this.calculator_;\r\n};\r\n\r\n\r\n/**\r\n * Add an array of markers to the clusterer.\r\n *\r\n * @param {Array.<google.maps.Marker>} markers The markers to add.\r\n * @param {boolean=} opt_nodraw Whether to redraw the clusters.\r\n */\r\nMarkerClusterer.prototype.addMarkers = function(markers, opt_nodraw) {\r\n  if (markers.length) {\r\n    for (var i = 0, marker; marker = markers[i]; i++) {\r\n      this.pushMarkerTo_(marker);\r\n    }\r\n  } else if (Object.keys(markers).length) {\r\n    for (var marker in markers) {\r\n      this.pushMarkerTo_(markers[marker]);\r\n    }\r\n  }\r\n  if (!opt_nodraw) {\r\n    this.redraw();\r\n  }\r\n};\r\n\r\n\r\n/**\r\n * Pushes a marker to the clusterer.\r\n *\r\n * @param {google.maps.Marker} marker The marker to add.\r\n * @private\r\n */\r\nMarkerClusterer.prototype.pushMarkerTo_ = function(marker) {\r\n  marker.isAdded = false;\r\n  if (marker['draggable']) {\r\n    // If the marker is draggable add a listener so we update the clusters on\r\n    // the drag end.\r\n    var that = this;\r\n    google.maps.event.addListener(marker, 'dragend', function() {\r\n      marker.isAdded = false;\r\n      that.repaint();\r\n    });\r\n  }\r\n  this.markers_.push(marker);\r\n};\r\n\r\n\r\n/**\r\n * Adds a marker to the clusterer and redraws if needed.\r\n *\r\n * @param {google.maps.Marker} marker The marker to add.\r\n * @param {boolean=} opt_nodraw Whether to redraw the clusters.\r\n */\r\nMarkerClusterer.prototype.addMarker = function(marker, opt_nodraw) {\r\n  this.pushMarkerTo_(marker);\r\n  if (!opt_nodraw) {\r\n    this.redraw();\r\n  }\r\n};\r\n\r\n\r\n/**\r\n * Removes a marker and returns true if removed, false if not\r\n *\r\n * @param {google.maps.Marker} marker The marker to remove\r\n * @return {boolean} Whether the marker was removed or not\r\n * @private\r\n */\r\nMarkerClusterer.prototype.removeMarker_ = function(marker) {\r\n  var index = -1;\r\n  if (this.markers_.indexOf) {\r\n    index = this.markers_.indexOf(marker);\r\n  } else {\r\n    for (var i = 0, m; m = this.markers_[i]; i++) {\r\n      if (m == marker) {\r\n        index = i;\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  if (index == -1) {\r\n    // Marker is not in our list of markers.\r\n    return false;\r\n  }\r\n\r\n  marker.setMap(null);\r\n\r\n  this.markers_.splice(index, 1);\r\n\r\n  return true;\r\n};\r\n\r\n\r\n/**\r\n * Remove a marker from the cluster.\r\n *\r\n * @param {google.maps.Marker} marker The marker to remove.\r\n * @param {boolean=} opt_nodraw Optional boolean to force no redraw.\r\n * @return {boolean} True if the marker was removed.\r\n */\r\nMarkerClusterer.prototype.removeMarker = function(marker, opt_nodraw) {\r\n  var removed = this.removeMarker_(marker);\r\n\r\n  if (!opt_nodraw && removed) {\r\n    this.resetViewport();\r\n    this.redraw();\r\n    return true;\r\n  } else {\r\n   return false;\r\n  }\r\n};\r\n\r\n\r\n/**\r\n * Removes an array of markers from the cluster.\r\n *\r\n * @param {Array.<google.maps.Marker>} markers The markers to remove.\r\n * @param {boolean=} opt_nodraw Optional boolean to force no redraw.\r\n */\r\nMarkerClusterer.prototype.removeMarkers = function(markers, opt_nodraw) {\r\n  // create a local copy of markers if required\r\n  // (removeMarker_ modifies the getMarkers() array in place)\r\n  var markersCopy = markers === this.getMarkers() ? markers.slice() : markers;\r\n  var removed = false;\r\n\r\n  for (var i = 0, marker; marker = markersCopy[i]; i++) {\r\n    var r = this.removeMarker_(marker);\r\n    removed = removed || r;\r\n  }\r\n\r\n  if (!opt_nodraw && removed) {\r\n    this.resetViewport();\r\n    this.redraw();\r\n    return true;\r\n  }\r\n};\r\n\r\n\r\n/**\r\n * Sets the clusterer's ready state.\r\n *\r\n * @param {boolean} ready The state.\r\n * @private\r\n */\r\nMarkerClusterer.prototype.setReady_ = function(ready) {\r\n  if (!this.ready_) {\r\n    this.ready_ = ready;\r\n    this.createClusters_();\r\n  }\r\n};\r\n\r\n\r\n/**\r\n * Returns the number of clusters in the clusterer.\r\n *\r\n * @return {number} The number of clusters.\r\n */\r\nMarkerClusterer.prototype.getTotalClusters = function() {\r\n  return this.clusters_.length;\r\n};\r\n\r\n\r\n/**\r\n * Returns the google map that the clusterer is associated with.\r\n *\r\n * @return {google.maps.Map} The map.\r\n */\r\nMarkerClusterer.prototype.getMap = function() {\r\n  return this.map_;\r\n};\r\n\r\n\r\n/**\r\n * Sets the google map that the clusterer is associated with.\r\n *\r\n * @param {google.maps.Map} map The map.\r\n */\r\nMarkerClusterer.prototype.setMap = function(map) {\r\n  this.map_ = map;\r\n};\r\n\r\n\r\n/**\r\n * Returns the size of the grid.\r\n *\r\n * @return {number} The grid size.\r\n */\r\nMarkerClusterer.prototype.getGridSize = function() {\r\n  return this.gridSize_;\r\n};\r\n\r\n\r\n/**\r\n * Sets the size of the grid.\r\n *\r\n * @param {number} size The grid size.\r\n */\r\nMarkerClusterer.prototype.setGridSize = function(size) {\r\n  this.gridSize_ = size;\r\n};\r\n\r\n\r\n/**\r\n * Returns the min cluster size.\r\n *\r\n * @return {number} The grid size.\r\n */\r\nMarkerClusterer.prototype.getMinClusterSize = function() {\r\n  return this.minClusterSize_;\r\n};\r\n\r\n/**\r\n * Sets the min cluster size.\r\n *\r\n * @param {number} size The grid size.\r\n */\r\nMarkerClusterer.prototype.setMinClusterSize = function(size) {\r\n  this.minClusterSize_ = size;\r\n};\r\n\r\n\r\n/**\r\n * Extends a bounds object by the grid size.\r\n *\r\n * @param {google.maps.LatLngBounds} bounds The bounds to extend.\r\n * @return {google.maps.LatLngBounds} The extended bounds.\r\n */\r\nMarkerClusterer.prototype.getExtendedBounds = function(bounds) {\r\n  var projection = this.getProjection();\r\n\r\n  // Turn the bounds into latlng.\r\n  var tr = new google.maps.LatLng(bounds.getNorthEast().lat(),\r\n      bounds.getNorthEast().lng());\r\n  var bl = new google.maps.LatLng(bounds.getSouthWest().lat(),\r\n      bounds.getSouthWest().lng());\r\n\r\n  // Convert the points to pixels and the extend out by the grid size.\r\n  var trPix = projection.fromLatLngToDivPixel(tr);\r\n  trPix.x += this.gridSize_;\r\n  trPix.y -= this.gridSize_;\r\n\r\n  var blPix = projection.fromLatLngToDivPixel(bl);\r\n  blPix.x -= this.gridSize_;\r\n  blPix.y += this.gridSize_;\r\n\r\n  // Convert the pixel points back to LatLng\r\n  var ne = projection.fromDivPixelToLatLng(trPix);\r\n  var sw = projection.fromDivPixelToLatLng(blPix);\r\n\r\n  // Extend the bounds to contain the new bounds.\r\n  bounds.extend(ne);\r\n  bounds.extend(sw);\r\n\r\n  return bounds;\r\n};\r\n\r\n\r\n/**\r\n * Determins if a marker is contained in a bounds.\r\n *\r\n * @param {google.maps.Marker} marker The marker to check.\r\n * @param {google.maps.LatLngBounds} bounds The bounds to check against.\r\n * @return {boolean} True if the marker is in the bounds.\r\n * @private\r\n */\r\nMarkerClusterer.prototype.isMarkerInBounds_ = function(marker, bounds) {\r\n  return bounds.contains(marker.getPosition());\r\n};\r\n\r\n\r\n/**\r\n * Clears all clusters and markers from the clusterer.\r\n */\r\nMarkerClusterer.prototype.clearMarkers = function() {\r\n  this.resetViewport(true);\r\n\r\n  // Set the markers a empty array.\r\n  this.markers_ = [];\r\n};\r\n\r\n\r\n/**\r\n * Clears all existing clusters and recreates them.\r\n * @param {boolean} opt_hide To also hide the marker.\r\n */\r\nMarkerClusterer.prototype.resetViewport = function(opt_hide) {\r\n  // Remove all the clusters\r\n  for (var i = 0, cluster; cluster = this.clusters_[i]; i++) {\r\n    cluster.remove();\r\n  }\r\n\r\n  // Reset the markers to not be added and to be invisible.\r\n  for (var i = 0, marker; marker = this.markers_[i]; i++) {\r\n    marker.isAdded = false;\r\n    if (opt_hide) {\r\n      marker.setMap(null);\r\n    }\r\n  }\r\n\r\n  this.clusters_ = [];\r\n};\r\n\r\n/**\r\n *\r\n */\r\nMarkerClusterer.prototype.repaint = function() {\r\n  var oldClusters = this.clusters_.slice();\r\n  this.clusters_.length = 0;\r\n  this.resetViewport();\r\n  this.redraw();\r\n\r\n  // Remove the old clusters.\r\n  // Do it in a timeout so the other clusters have been drawn first.\r\n  window.setTimeout(function() {\r\n    for (var i = 0, cluster; cluster = oldClusters[i]; i++) {\r\n      cluster.remove();\r\n    }\r\n  }, 0);\r\n};\r\n\r\n\r\n/**\r\n * Redraws the clusters.\r\n */\r\nMarkerClusterer.prototype.redraw = function() {\r\n  this.createClusters_();\r\n};\r\n\r\n\r\n/**\r\n * Calculates the distance between two latlng locations in km.\r\n * @see http://www.movable-type.co.uk/scripts/latlong.html\r\n *\r\n * @param {google.maps.LatLng} p1 The first lat lng point.\r\n * @param {google.maps.LatLng} p2 The second lat lng point.\r\n * @return {number} The distance between the two points in km.\r\n * @private\r\n*/\r\nMarkerClusterer.prototype.distanceBetweenPoints_ = function(p1, p2) {\r\n  if (!p1 || !p2) {\r\n    return 0;\r\n  }\r\n\r\n  var R = 6371; // Radius of the Earth in km\r\n  var dLat = (p2.lat() - p1.lat()) * Math.PI / 180;\r\n  var dLon = (p2.lng() - p1.lng()) * Math.PI / 180;\r\n  var a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +\r\n    Math.cos(p1.lat() * Math.PI / 180) * Math.cos(p2.lat() * Math.PI / 180) *\r\n    Math.sin(dLon / 2) * Math.sin(dLon / 2);\r\n  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n  var d = R * c;\r\n  return d;\r\n};\r\n\r\n\r\n/**\r\n * Add a marker to a cluster, or creates a new cluster.\r\n *\r\n * @param {google.maps.Marker} marker The marker to add.\r\n * @private\r\n */\r\nMarkerClusterer.prototype.addToClosestCluster_ = function(marker) {\r\n  var distance = 40000; // Some large number\r\n  var clusterToAddTo = null;\r\n  var pos = marker.getPosition();\r\n  for (var i = 0, cluster; cluster = this.clusters_[i]; i++) {\r\n    var center = cluster.getCenter();\r\n    if (center) {\r\n      var d = this.distanceBetweenPoints_(center, marker.getPosition());\r\n      if (d < distance) {\r\n        distance = d;\r\n        clusterToAddTo = cluster;\r\n      }\r\n    }\r\n  }\r\n\r\n  if (clusterToAddTo && clusterToAddTo.isMarkerInClusterBounds(marker)) {\r\n    clusterToAddTo.addMarker(marker);\r\n  } else {\r\n    var cluster = new Cluster(this);\r\n    cluster.addMarker(marker);\r\n    this.clusters_.push(cluster);\r\n  }\r\n};\r\n\r\n\r\n/**\r\n * Creates the clusters.\r\n *\r\n * @private\r\n */\r\nMarkerClusterer.prototype.createClusters_ = function() {\r\n  if (!this.ready_) {\r\n    return;\r\n  }\r\n\r\n  // Get our current map view bounds.\r\n  // Create a new bounds object so we don't affect the map.\r\n  var mapBounds = new google.maps.LatLngBounds(this.map_.getBounds().getSouthWest(),\r\n      this.map_.getBounds().getNorthEast());\r\n  var bounds = this.getExtendedBounds(mapBounds);\r\n\r\n  for (var i = 0, marker; marker = this.markers_[i]; i++) {\r\n    if (!marker.isAdded && this.isMarkerInBounds_(marker, bounds)) {\r\n      this.addToClosestCluster_(marker);\r\n    }\r\n  }\r\n};\r\n\r\n\r\n/**\r\n * A cluster that contains markers.\r\n *\r\n * @param {MarkerClusterer} markerClusterer The markerclusterer that this\r\n *     cluster is associated with.\r\n * @constructor\r\n * @ignore\r\n */\r\nfunction Cluster(markerClusterer) {\r\n  this.markerClusterer_ = markerClusterer;\r\n  this.map_ = markerClusterer.getMap();\r\n  this.gridSize_ = markerClusterer.getGridSize();\r\n  this.minClusterSize_ = markerClusterer.getMinClusterSize();\r\n  this.averageCenter_ = markerClusterer.isAverageCenter();\r\n  this.center_ = null;\r\n  this.markers_ = [];\r\n  this.bounds_ = null;\r\n  this.clusterIcon_ = new ClusterIcon(this, markerClusterer.getStyles(),\r\n      markerClusterer.getGridSize());\r\n}\r\n\r\n/**\r\n * Determins if a marker is already added to the cluster.\r\n *\r\n * @param {google.maps.Marker} marker The marker to check.\r\n * @return {boolean} True if the marker is already added.\r\n */\r\nCluster.prototype.isMarkerAlreadyAdded = function(marker) {\r\n  if (this.markers_.indexOf) {\r\n    return this.markers_.indexOf(marker) != -1;\r\n  } else {\r\n    for (var i = 0, m; m = this.markers_[i]; i++) {\r\n      if (m == marker) {\r\n        return true;\r\n      }\r\n    }\r\n  }\r\n  return false;\r\n};\r\n\r\n\r\n/**\r\n * Add a marker the cluster.\r\n *\r\n * @param {google.maps.Marker} marker The marker to add.\r\n * @return {boolean} True if the marker was added.\r\n */\r\nCluster.prototype.addMarker = function(marker) {\r\n  if (this.isMarkerAlreadyAdded(marker)) {\r\n    return false;\r\n  }\r\n\r\n  if (!this.center_) {\r\n    this.center_ = marker.getPosition();\r\n    this.calculateBounds_();\r\n  } else {\r\n    if (this.averageCenter_) {\r\n      var l = this.markers_.length + 1;\r\n      var lat = (this.center_.lat() * (l-1) + marker.getPosition().lat()) / l;\r\n      var lng = (this.center_.lng() * (l-1) + marker.getPosition().lng()) / l;\r\n      this.center_ = new google.maps.LatLng(lat, lng);\r\n      this.calculateBounds_();\r\n    }\r\n  }\r\n\r\n  marker.isAdded = true;\r\n  this.markers_.push(marker);\r\n\r\n  var len = this.markers_.length;\r\n  if (len < this.minClusterSize_ && marker.getMap() != this.map_) {\r\n    // Min cluster size not reached so show the marker.\r\n    marker.setMap(this.map_);\r\n  }\r\n\r\n  if (len == this.minClusterSize_) {\r\n    // Hide the markers that were showing.\r\n    for (var i = 0; i < len; i++) {\r\n      this.markers_[i].setMap(null);\r\n    }\r\n  }\r\n\r\n  if (len >= this.minClusterSize_) {\r\n    marker.setMap(null);\r\n  }\r\n\r\n  this.updateIcon();\r\n  return true;\r\n};\r\n\r\n\r\n/**\r\n * Returns the marker clusterer that the cluster is associated with.\r\n *\r\n * @return {MarkerClusterer} The associated marker clusterer.\r\n */\r\nCluster.prototype.getMarkerClusterer = function() {\r\n  return this.markerClusterer_;\r\n};\r\n\r\n\r\n/**\r\n * Returns the bounds of the cluster.\r\n *\r\n * @return {google.maps.LatLngBounds} the cluster bounds.\r\n */\r\nCluster.prototype.getBounds = function() {\r\n  var bounds = new google.maps.LatLngBounds(this.center_, this.center_);\r\n  var markers = this.getMarkers();\r\n  for (var i = 0, marker; marker = markers[i]; i++) {\r\n    bounds.extend(marker.getPosition());\r\n  }\r\n  return bounds;\r\n};\r\n\r\n\r\n/**\r\n * Removes the cluster\r\n */\r\nCluster.prototype.remove = function() {\r\n  this.clusterIcon_.remove();\r\n  this.markers_.length = 0;\r\n  delete this.markers_;\r\n};\r\n\r\n\r\n/**\r\n * Returns the number of markers in the cluster.\r\n *\r\n * @return {number} The number of markers in the cluster.\r\n */\r\nCluster.prototype.getSize = function() {\r\n  return this.markers_.length;\r\n};\r\n\r\n\r\n/**\r\n * Returns a list of the markers in the cluster.\r\n *\r\n * @return {Array.<google.maps.Marker>} The markers in the cluster.\r\n */\r\nCluster.prototype.getMarkers = function() {\r\n  return this.markers_;\r\n};\r\n\r\n\r\n/**\r\n * Returns the center of the cluster.\r\n *\r\n * @return {google.maps.LatLng} The cluster center.\r\n */\r\nCluster.prototype.getCenter = function() {\r\n  return this.center_;\r\n};\r\n\r\n\r\n/**\r\n * Calculated the extended bounds of the cluster with the grid.\r\n *\r\n * @private\r\n */\r\nCluster.prototype.calculateBounds_ = function() {\r\n  var bounds = new google.maps.LatLngBounds(this.center_, this.center_);\r\n  this.bounds_ = this.markerClusterer_.getExtendedBounds(bounds);\r\n};\r\n\r\n\r\n/**\r\n * Determines if a marker lies in the clusters bounds.\r\n *\r\n * @param {google.maps.Marker} marker The marker to check.\r\n * @return {boolean} True if the marker lies in the bounds.\r\n */\r\nCluster.prototype.isMarkerInClusterBounds = function(marker) {\r\n  return this.bounds_.contains(marker.getPosition());\r\n};\r\n\r\n\r\n/**\r\n * Returns the map that the cluster is associated with.\r\n *\r\n * @return {google.maps.Map} The map.\r\n */\r\nCluster.prototype.getMap = function() {\r\n  return this.map_;\r\n};\r\n\r\n\r\n/**\r\n * Updates the cluster icon\r\n */\r\nCluster.prototype.updateIcon = function() {\r\n  var zoom = this.map_.getZoom();\r\n  var mz = this.markerClusterer_.getMaxZoom();\r\n\r\n  if (mz && zoom > mz) {\r\n    // The zoom is greater than our max zoom so show all the markers in cluster.\r\n    for (var i = 0, marker; marker = this.markers_[i]; i++) {\r\n      marker.setMap(this.map_);\r\n    }\r\n    return;\r\n  }\r\n\r\n  if (this.markers_.length < this.minClusterSize_) {\r\n    // Min cluster size not yet reached.\r\n    this.clusterIcon_.hide();\r\n    return;\r\n  }\r\n\r\n  var numStyles = this.markerClusterer_.getStyles().length;\r\n  var sums = this.markerClusterer_.getCalculator()(this.markers_, numStyles);\r\n  this.clusterIcon_.setCenter(this.center_);\r\n  this.clusterIcon_.setSums(sums);\r\n  this.clusterIcon_.show();\r\n};\r\n\r\n\r\n/**\r\n * A cluster icon\r\n *\r\n * @param {Cluster} cluster The cluster to be associated with.\r\n * @param {Object} styles An object that has style properties:\r\n *     'url': (string) The image url.\r\n *     'height': (number) The image height.\r\n *     'width': (number) The image width.\r\n *     'anchor': (Array) The anchor position of the label text.\r\n *     'textColor': (string) The text color.\r\n *     'textSize': (number) The text size.\r\n *     'backgroundPosition: (string) The background postition x, y.\r\n * @param {number=} opt_padding Optional padding to apply to the cluster icon.\r\n * @constructor\r\n * @extends google.maps.OverlayView\r\n * @ignore\r\n */\r\nfunction ClusterIcon(cluster, styles, opt_padding) {\r\n  cluster.getMarkerClusterer().extend(ClusterIcon, google.maps.OverlayView);\r\n\r\n  this.styles_ = styles;\r\n  this.padding_ = opt_padding || 0;\r\n  this.cluster_ = cluster;\r\n  this.center_ = null;\r\n  this.map_ = cluster.getMap();\r\n  this.div_ = null;\r\n  this.sums_ = null;\r\n  this.visible_ = false;\r\n\r\n  this.setMap(this.map_);\r\n}\r\n\r\n\r\n/**\r\n * Triggers the clusterclick event and zoom's if the option is set.\r\n */\r\nClusterIcon.prototype.triggerClusterClick = function() {\r\n  var markerClusterer = this.cluster_.getMarkerClusterer();\r\n\r\n  // Trigger the clusterclick event.\r\n  google.maps.event.trigger(markerClusterer, 'clusterclick', this.cluster_);\r\n\r\n  if (markerClusterer.isZoomOnClick()) {\r\n    // Zoom into the cluster.\r\n    this.map_.fitBounds(this.cluster_.getBounds());\r\n  }\r\n};\r\n\r\n\r\n/**\r\n * Adding the cluster icon to the dom.\r\n * @ignore\r\n */\r\nClusterIcon.prototype.onAdd = function() {\r\n  this.div_ = document.createElement('DIV');\r\n  var panes = this.getPanes();\r\n  if (this.visible_) {\r\n    var pos = this.getPosFromLatLng_(this.center_);\r\n    this.div_.style.cssText = this.createCss(pos);\r\n    this.div_.innerHTML = this.sums_.text;\r\n    if( this.sums_.text ){\r\n      panes.overlayMouseTarget.classList.add('shiftms-map-cluster-icon');\r\n      if( this.sums_.text > 1000 ){\r\n        this.div_.classList.add('shiftms-map-cluster-icon-large-num');\r\n      }\r\n\r\n      if( this.sums_.text > 0 ){\r\n        this.div_.classList.add('shiftms-map-cluster-icon-is-cluster');  \r\n      }\r\n    }\r\n  }\r\n\r\n  panes.overlayMouseTarget.appendChild(this.div_);\r\n\r\n  var that = this;\r\n  google.maps.event.addDomListener(this.div_, 'click', function() {\r\n    that.triggerClusterClick();\r\n  });\r\n};\r\n\r\n\r\n/**\r\n * Returns the position to place the div dending on the latlng.\r\n *\r\n * @param {google.maps.LatLng} latlng The position in latlng.\r\n * @return {google.maps.Point} The position in pixels.\r\n * @private\r\n */\r\nClusterIcon.prototype.getPosFromLatLng_ = function(latlng) {\r\n  var pos = this.getProjection().fromLatLngToDivPixel(latlng);\r\n  pos.x -= parseInt(this.width_ / 2, 10);\r\n  pos.y -= parseInt(this.height_ / 2, 10);\r\n  return pos;\r\n};\r\n\r\n\r\n/**\r\n * Draw the icon.\r\n * @ignore\r\n */\r\nClusterIcon.prototype.draw = function() {\r\n  if (this.visible_) {\r\n    var pos = this.getPosFromLatLng_(this.center_);\r\n    this.div_.style.top = pos.y + 'px';\r\n    this.div_.style.left = pos.x + 'px';\r\n  }\r\n};\r\n\r\n\r\n/**\r\n * Hide the icon.\r\n */\r\nClusterIcon.prototype.hide = function() {\r\n  if (this.div_) {\r\n    this.div_.style.display = 'none';\r\n  }\r\n  this.visible_ = false;\r\n};\r\n\r\n\r\n/**\r\n * Position and show the icon.\r\n */\r\nClusterIcon.prototype.show = function() {\r\n  if (this.div_) {\r\n    var pos = this.getPosFromLatLng_(this.center_);\r\n    this.div_.style.cssText = this.createCss(pos);\r\n    this.div_.style.display = '';\r\n  }\r\n  this.visible_ = true;\r\n};\r\n\r\n\r\n/**\r\n * Remove the icon from the map\r\n */\r\nClusterIcon.prototype.remove = function() {\r\n  this.setMap(null);\r\n};\r\n\r\n\r\n/**\r\n * Implementation of the onRemove interface.\r\n * @ignore\r\n */\r\nClusterIcon.prototype.onRemove = function() {\r\n  if (this.div_ && this.div_.parentNode) {\r\n    this.hide();\r\n    this.div_.parentNode.removeChild(this.div_);\r\n    this.div_ = null;\r\n  }\r\n};\r\n\r\n\r\n/**\r\n * Set the sums of the icon.\r\n *\r\n * @param {Object} sums The sums containing:\r\n *   'text': (string) The text to display in the icon.\r\n *   'index': (number) The style index of the icon.\r\n */\r\nClusterIcon.prototype.setSums = function(sums) {\r\n  this.sums_ = sums;\r\n  this.text_ = sums.text;\r\n  this.index_ = sums.index;\r\n  if (this.div_) {\r\n    this.div_.innerHTML = sums.text;\r\n  }\r\n\r\n  this.useStyle();\r\n};\r\n\r\n\r\n/**\r\n * Sets the icon to the the styles.\r\n */\r\nClusterIcon.prototype.useStyle = function() {\r\n  var index = Math.max(0, this.sums_.index - 1);\r\n  index = Math.min(this.styles_.length - 1, index);\r\n  var style = this.styles_[index];\r\n  this.url_ = style['url'];\r\n  this.height_ = style['height'];\r\n  this.width_ = style['width'];\r\n  this.textColor_ = style['textColor'];\r\n  this.anchor_ = style['anchor'];\r\n  this.textSize_ = style['textSize'];\r\n  this.backgroundPosition_ = style['backgroundPosition'];\r\n};\r\n\r\n\r\n/**\r\n * Sets the center of the icon.\r\n *\r\n * @param {google.maps.LatLng} center The latlng to set as the center.\r\n */\r\nClusterIcon.prototype.setCenter = function(center) {\r\n  this.center_ = center;\r\n};\r\n\r\n\r\n/**\r\n * Create the css text based on the position of the icon.\r\n *\r\n * @param {google.maps.Point} pos The position.\r\n * @return {string} The css style text.\r\n */\r\nClusterIcon.prototype.createCss = function(pos) {\r\n  var style = [];\r\n  style.push('background-image:url(' + this.url_ + ');');\r\n  var backgroundPosition = this.backgroundPosition_ ? this.backgroundPosition_ : '0 0';\r\n  style.push('background-position:' + backgroundPosition + ';');\r\n\r\n  if (typeof this.anchor_ === 'object') {\r\n    if (typeof this.anchor_[0] === 'number' && this.anchor_[0] > 0 &&\r\n        this.anchor_[0] < this.height_) {\r\n      style.push('height:' + (this.height_ - this.anchor_[0]) +\r\n          'px; padding-top:' + this.anchor_[0] + 'px;');\r\n    } else {\r\n      style.push('height:' + this.height_ + 'px; line-height:' + this.height_ +\r\n          'px;');\r\n    }\r\n    if (typeof this.anchor_[1] === 'number' && this.anchor_[1] > 0 &&\r\n        this.anchor_[1] < this.width_) {\r\n      style.push('width:' + (this.width_ - this.anchor_[1]) +\r\n          'px; padding-left:' + this.anchor_[1] + 'px;');\r\n    } else {\r\n      style.push('width:' + this.width_ + 'px; text-align:center;');\r\n    }\r\n  } else {\r\n    style.push('height:' + this.height_ + 'px; line-height:' +\r\n        this.height_ + 'px; width:' + this.width_ + 'px; text-align:center;');\r\n  }\r\n\r\n  var txtColor = this.textColor_ ? this.textColor_ : 'black';\r\n  var txtSize = this.textSize_ ? this.textSize_ : 11;\r\n\r\n  style.push('cursor:pointer; top:' + pos.y + 'px; left:' +\r\n      pos.x + 'px; color:' + txtColor + '; position:absolute; font-size:' +\r\n      txtSize + 'px; font-family:Arial,sans-serif; font-weight:bold');\r\n  return style.join('');\r\n};\r\n\r\n\r\n// Export Symbols for Closure\r\n// If you are not going to compile with closure then you can remove the\r\n// code below.\r\nwindow['MarkerClusterer'] = MarkerClusterer;\r\nMarkerClusterer.prototype['addMarker'] = MarkerClusterer.prototype.addMarker;\r\nMarkerClusterer.prototype['addMarkers'] = MarkerClusterer.prototype.addMarkers;\r\nMarkerClusterer.prototype['clearMarkers'] =\r\n    MarkerClusterer.prototype.clearMarkers;\r\nMarkerClusterer.prototype['fitMapToMarkers'] =\r\n    MarkerClusterer.prototype.fitMapToMarkers;\r\nMarkerClusterer.prototype['getCalculator'] =\r\n    MarkerClusterer.prototype.getCalculator;\r\nMarkerClusterer.prototype['getGridSize'] =\r\n    MarkerClusterer.prototype.getGridSize;\r\nMarkerClusterer.prototype['getExtendedBounds'] =\r\n    MarkerClusterer.prototype.getExtendedBounds;\r\nMarkerClusterer.prototype['getMap'] = MarkerClusterer.prototype.getMap;\r\nMarkerClusterer.prototype['getMarkers'] = MarkerClusterer.prototype.getMarkers;\r\nMarkerClusterer.prototype['getMaxZoom'] = MarkerClusterer.prototype.getMaxZoom;\r\nMarkerClusterer.prototype['getStyles'] = MarkerClusterer.prototype.getStyles;\r\nMarkerClusterer.prototype['getTotalClusters'] =\r\n    MarkerClusterer.prototype.getTotalClusters;\r\nMarkerClusterer.prototype['getTotalMarkers'] =\r\n    MarkerClusterer.prototype.getTotalMarkers;\r\nMarkerClusterer.prototype['redraw'] = MarkerClusterer.prototype.redraw;\r\nMarkerClusterer.prototype['removeMarker'] =\r\n    MarkerClusterer.prototype.removeMarker;\r\nMarkerClusterer.prototype['removeMarkers'] =\r\n    MarkerClusterer.prototype.removeMarkers;\r\nMarkerClusterer.prototype['resetViewport'] =\r\n    MarkerClusterer.prototype.resetViewport;\r\nMarkerClusterer.prototype['repaint'] =\r\n    MarkerClusterer.prototype.repaint;\r\nMarkerClusterer.prototype['setCalculator'] =\r\n    MarkerClusterer.prototype.setCalculator;\r\nMarkerClusterer.prototype['setGridSize'] =\r\n    MarkerClusterer.prototype.setGridSize;\r\nMarkerClusterer.prototype['setMaxZoom'] =\r\n    MarkerClusterer.prototype.setMaxZoom;\r\nMarkerClusterer.prototype['onAdd'] = MarkerClusterer.prototype.onAdd;\r\nMarkerClusterer.prototype['draw'] = MarkerClusterer.prototype.draw;\r\n\r\nCluster.prototype['getCenter'] = Cluster.prototype.getCenter;\r\nCluster.prototype['getSize'] = Cluster.prototype.getSize;\r\nCluster.prototype['getMarkers'] = Cluster.prototype.getMarkers;\r\n\r\nClusterIcon.prototype['onAdd'] = ClusterIcon.prototype.onAdd;\r\nClusterIcon.prototype['draw'] = ClusterIcon.prototype.draw;\r\nClusterIcon.prototype['onRemove'] = ClusterIcon.prototype.onRemove;\r\n\r\nObject.keys = Object.keys || function(o) {  \r\n    var result = [];  \r\n    for(var name in o) {  \r\n        if (o.hasOwnProperty(name))  \r\n          result.push(name);  \r\n    }  \r\n    return result;  \r\n};\r\n\r\nexport default MarkerClusterer;","const pngsList = {\r\n\t'person-001' : [40,63],\r\n\t'person-002' : [38,63],\r\n\t'person-003' : [45,43],\r\n\t'person-004' : [40,62],\r\n\t'person-005' : [39,63],\r\n\t'person-006' : [41,63],\r\n\t'person-007' : [38,63],\r\n\t'person-008' : [40,63],\r\n\t'person-009' : [37,62],\r\n\t'person-010' : [37,62],\r\n\t'person-011' : [38,63],\r\n\t'person-012' : [37,61],\r\n\t'person-013' : [36,63],\r\n\t'person-014' : [37,63],\r\n\t'person-015' : [39,62],\r\n\t'person-016' : [38,62],\r\n\t'person-017' : [37,61],\r\n\t'person-018' : [37,63],\r\n\t'person-019' : [36,61],\r\n\t'person-020' : [39,61],\r\n\t'person-021' : [37,61],\r\n\t'person-022' : [37,60],\r\n\t'person-023' : [41,68],\r\n\t'person-024' : [40,61],\r\n\t'person-025' : [36,61],\r\n\t'person-026' : [38,61],\r\n\t'person-027' : [38,60],\r\n\t'person-028' : [36,60],\r\n\t'person-029' : [37,65],\r\n\t'person-030' : [35,61],\r\n\t'person-031' : [37,63],\r\n\t'person-032' : [44,53],\r\n\t'person-033' : [39,63],\r\n\t'person-034' : [39,63],\r\n\t'person-035' : [68,65],\r\n\t'person-036' : [37,60],\r\n\t'person-037' : [37,60],\r\n\t'person-038' : [37,60],\r\n\t'person-039' : [36,61],\r\n\t'person-040' : [57,62],\r\n\t'person-041' : [65,63],\r\n\t'person-042' : [40,63],\r\n\t'person-043' : [40,63],\r\n\t'person-044' : [49,66],\r\n\t'person-045' : [37,65]\r\n}\r\n\r\nexport default pngsList;\r\n","import Clusterize from 'clusterize.js';\r\nimport { getClusterOptions } from '../map/options';\r\nimport buildList from '../buildList/buildList';\r\nimport checkData from './checkData';\r\nimport getRandom from './getRandom';\r\nimport MarkerClusterer from '../map/markerclusterer.js';\r\nimport pngsList from '../characters/iconsList';\r\n\r\n\r\nconst $ = jQuery;\r\nlet mapDragging = false;\r\n\r\nconst fetchData = (map, data, markers, url, domElement, assetsPath) => {\r\n\r\n\tconst clusterOptions  = getClusterOptions();\r\n\r\n\tlet localMap = map;\r\n\tlet listArray = [];\r\n\tlet avatarURL = url;\r\n\tlet j = 0;\r\n\r\n\tconst pngs = Object.keys(pngsList);\r\n\tconst maxZoomLevel = 13; \r\n\tconst scrollElement = $(domElement).find(\".shiftmap-map-clusterise-wrapper\").get(0);\r\n\tconst contentElement = $(domElement).find(\".shiftmap-clusterize-content-wrapper\").get(0);\r\n\r\n\t// Create list\r\n\tlet clusterize = new Clusterize({\r\n\t\trows: null,\r\n\t\trows_in_block: 2,\r\n\t\tscrollElem: scrollElement,\r\n\t\tcontentElem: contentElement,\r\n\t\tno_data_text: 'No users within range'\r\n\t});\r\n\r\n\t// Add markers\r\n\tif (checkData(data)) {\r\n\t\tdata.map((markerPosition) => {\r\n\t\t\tif (!markerPosition.latitude || !markerPosition.longitude) {\r\n\t\t\t\tconsole.warn('Could not find coordinates on data provided from userID: ', markerPosition.user_id);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (j === pngs.length) {j = 0};\r\n\r\n\t\t\t\tconst randKey = Math.floor((Math.random()*1000)/10 * (pngs.length/100));\r\n\t\t\t\tconst img = pngs[randKey]||pngs[0];\r\n\t\t\t\tconst imgSize = pngsList[img];\r\n\r\n\t\t\t\tlet icon = {\r\n\t\t\t\t\turl: `${assetsPath}${img}.png`,\r\n\t\t\t\t\tsize: new google.maps.Size(imgSize[0], imgSize[1]),\r\n\t\t\t\t\torigin: new google.maps.Point(0, 0),\r\n\t\t\t\t\tanchor: new google.maps.Point(17, 34),\r\n\t\t\t\t\tscaledSize: new google.maps.Size(imgSize[0], imgSize[1]),\r\n\t\t\t\t};\r\n\r\n\t\t\t\tlet location = new google.maps.LatLng({\r\n\t\t\t\t\tlat: markerPosition.latitude + getRandom(0, 0.5), \r\n\t\t\t\t\tlng: markerPosition.longitude + getRandom(0, 0.5)\r\n\t\t\t\t});\r\n\r\n\t\t\t\tconst marker = new google.maps.Marker({\r\n\t\t\t\t\tposition: location,\r\n\t\t\t\t\tmap: localMap,\r\n\t\t\t\t\ticon: icon,\r\n\t\t\t\t\toptimized: false,\r\n\t\t\t\t\tzindex: 0,\r\n\t\t\t\t\tuserID: markerPosition.user_id,\r\n\t\t\t\t\tuserName: markerPosition.full_name,\r\n\t\t\t\t\tcountry: markerPosition.country,\r\n\t\t\t\t\tcity: markerPosition.city,\r\n\t\t\t\t\turl: markerPosition.avatar || './img/person-example.png',\r\n\t\t\t\t});\r\n\t\t\t\tmarkers.push(marker);\r\n\t\t\t\tj++;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// Create MarkerClusterer\r\n\t\tconst markerCluster = new MarkerClusterer(localMap, markers, clusterOptions);\r\n\r\n\t\t// Updates list when viewport changes\r\n\t\tgoogle.maps.event.addListener(localMap, 'bounds_changed', function() {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tbuildList(clusterize, listArray, markers, localMap, domElement);\r\n\t\t\t}, 200 );\r\n\t\t});\r\n\r\n\t\tgoogle.maps.event.addListener(map, \"idle\", function() {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tgoogle.maps.event.trigger(map, 'resize');\r\n\t\t\t}, 200 );\r\n\t\t});\r\n\r\n\t\tgoogle.maps.event.addListener(map, \"drag\", () => {\r\n\t\t\tmapDragging = true;\r\n\t\t});\r\n\r\n\t\tgoogle.maps.event.addListener(map, \"dragend\", () => {\r\n\t\t\tsetTimeout(() => mapDragging = false, 50 );\r\n\t\t});\r\n\r\n\t\t// Limit the zoom level\r\n\t\tgoogle.maps.event.addListener(map, 'zoom_changed', function() {\r\n\t\t\tif (map.getZoom() > maxZoomLevel) map.setZoom(maxZoomLevel);\r\n\t\t});\r\n\r\n\t\tbindListeners( map, markerCluster );\r\n\t}\r\n};\r\n\r\nexport default fetchData;\r\n\r\nconst bindListeners = ( map, markerCluster ) => {\r\n\tgoogle.maps.event.addListener(markerCluster, \"clusterclick\", (cluster) => {\r\n\t\t// Stops event propagation\r\n\t\t// Ugly but can't find event.preventDefault\r\n\t\tif(mapDragging){\t\r\n\t\t\tthrow \"Cannot click while dragging\"\r\n\t\t}\r\n\t});\r\n}\r\n\r\n","import { getMapOptions } from './options';\r\nimport template from '../../template.html';\r\n\r\nconst createMap = (domElement) => {\r\n\tconst $ = window.jQuery;\r\n\tconst $wrapper = $(domElement).html(template);\r\n\tconst $map = $wrapper.find('.shiftmap-map');\r\n\tconst opt = getMapOptions();\r\n\treturn new google.maps.Map($map.get(0), opt);\t\r\n}\r\n\r\nexport default createMap;\r\n","(function (root) {\n\n  // Store setTimeout reference so promise-polyfill will be unaffected by\n  // other code modifying setTimeout (like sinon.useFakeTimers())\n  var setTimeoutFunc = setTimeout;\n\n  function noop() {}\n  \n  // Polyfill for Function.prototype.bind\n  function bind(fn, thisArg) {\n    return function () {\n      fn.apply(thisArg, arguments);\n    };\n  }\n\n  function Promise(fn) {\n    if (typeof this !== 'object') throw new TypeError('Promises must be constructed via new');\n    if (typeof fn !== 'function') throw new TypeError('not a function');\n    this._state = 0;\n    this._handled = false;\n    this._value = undefined;\n    this._deferreds = [];\n\n    doResolve(fn, this);\n  }\n\n  function handle(self, deferred) {\n    while (self._state === 3) {\n      self = self._value;\n    }\n    if (self._state === 0) {\n      self._deferreds.push(deferred);\n      return;\n    }\n    self._handled = true;\n    Promise._immediateFn(function () {\n      var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n      if (cb === null) {\n        (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n        return;\n      }\n      var ret;\n      try {\n        ret = cb(self._value);\n      } catch (e) {\n        reject(deferred.promise, e);\n        return;\n      }\n      resolve(deferred.promise, ret);\n    });\n  }\n\n  function resolve(self, newValue) {\n    try {\n      // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n      if (newValue === self) throw new TypeError('A promise cannot be resolved with itself.');\n      if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n        var then = newValue.then;\n        if (newValue instanceof Promise) {\n          self._state = 3;\n          self._value = newValue;\n          finale(self);\n          return;\n        } else if (typeof then === 'function') {\n          doResolve(bind(then, newValue), self);\n          return;\n        }\n      }\n      self._state = 1;\n      self._value = newValue;\n      finale(self);\n    } catch (e) {\n      reject(self, e);\n    }\n  }\n\n  function reject(self, newValue) {\n    self._state = 2;\n    self._value = newValue;\n    finale(self);\n  }\n\n  function finale(self) {\n    if (self._state === 2 && self._deferreds.length === 0) {\n      Promise._immediateFn(function() {\n        if (!self._handled) {\n          Promise._unhandledRejectionFn(self._value);\n        }\n      });\n    }\n\n    for (var i = 0, len = self._deferreds.length; i < len; i++) {\n      handle(self, self._deferreds[i]);\n    }\n    self._deferreds = null;\n  }\n\n  function Handler(onFulfilled, onRejected, promise) {\n    this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n    this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n    this.promise = promise;\n  }\n\n  /**\n   * Take a potentially misbehaving resolver function and make sure\n   * onFulfilled and onRejected are only called once.\n   *\n   * Makes no guarantees about asynchrony.\n   */\n  function doResolve(fn, self) {\n    var done = false;\n    try {\n      fn(function (value) {\n        if (done) return;\n        done = true;\n        resolve(self, value);\n      }, function (reason) {\n        if (done) return;\n        done = true;\n        reject(self, reason);\n      });\n    } catch (ex) {\n      if (done) return;\n      done = true;\n      reject(self, ex);\n    }\n  }\n\n  Promise.prototype['catch'] = function (onRejected) {\n    return this.then(null, onRejected);\n  };\n\n  Promise.prototype.then = function (onFulfilled, onRejected) {\n    var prom = new (this.constructor)(noop);\n\n    handle(this, new Handler(onFulfilled, onRejected, prom));\n    return prom;\n  };\n\n  Promise.all = function (arr) {\n    var args = Array.prototype.slice.call(arr);\n\n    return new Promise(function (resolve, reject) {\n      if (args.length === 0) return resolve([]);\n      var remaining = args.length;\n\n      function res(i, val) {\n        try {\n          if (val && (typeof val === 'object' || typeof val === 'function')) {\n            var then = val.then;\n            if (typeof then === 'function') {\n              then.call(val, function (val) {\n                res(i, val);\n              }, reject);\n              return;\n            }\n          }\n          args[i] = val;\n          if (--remaining === 0) {\n            resolve(args);\n          }\n        } catch (ex) {\n          reject(ex);\n        }\n      }\n\n      for (var i = 0; i < args.length; i++) {\n        res(i, args[i]);\n      }\n    });\n  };\n\n  Promise.resolve = function (value) {\n    if (value && typeof value === 'object' && value.constructor === Promise) {\n      return value;\n    }\n\n    return new Promise(function (resolve) {\n      resolve(value);\n    });\n  };\n\n  Promise.reject = function (value) {\n    return new Promise(function (resolve, reject) {\n      reject(value);\n    });\n  };\n\n  Promise.race = function (values) {\n    return new Promise(function (resolve, reject) {\n      for (var i = 0, len = values.length; i < len; i++) {\n        values[i].then(resolve, reject);\n      }\n    });\n  };\n\n  // Use polyfill for setImmediate for performance gains\n  Promise._immediateFn = (typeof setImmediate === 'function' && function (fn) { setImmediate(fn); }) ||\n    function (fn) {\n      setTimeoutFunc(fn, 0);\n    };\n\n  Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n    if (typeof console !== 'undefined' && console) {\n      console.warn('Possible Unhandled Promise Rejection:', err); // eslint-disable-line no-console\n    }\n  };\n\n  /**\n   * Set the immediate function to execute callbacks\n   * @param fn {function} Function to execute\n   * @deprecated\n   */\n  Promise._setImmediateFn = function _setImmediateFn(fn) {\n    Promise._immediateFn = fn;\n  };\n\n  /**\n   * Change the function to execute on unhandled rejection\n   * @param {function} fn Function to execute on unhandled rejection\n   * @deprecated\n   */\n  Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n    Promise._unhandledRejectionFn = fn;\n  };\n  \n  if (typeof module !== 'undefined' && module.exports) {\n    module.exports = Promise;\n  } else if (!root.Promise) {\n    root.Promise = Promise;\n  }\n\n})(this);\n","import Promise from 'promise-polyfill'; \r\n\r\nif (!window.Promise) {\r\n  window.Promise = Promise;\r\n}","(function(self) {\n  'use strict';\n\n  if (self.fetch) {\n    return\n  }\n\n  var support = {\n    searchParams: 'URLSearchParams' in self,\n    iterable: 'Symbol' in self && 'iterator' in Symbol,\n    blob: 'FileReader' in self && 'Blob' in self && (function() {\n      try {\n        new Blob()\n        return true\n      } catch(e) {\n        return false\n      }\n    })(),\n    formData: 'FormData' in self,\n    arrayBuffer: 'ArrayBuffer' in self\n  }\n\n  if (support.arrayBuffer) {\n    var viewClasses = [\n      '[object Int8Array]',\n      '[object Uint8Array]',\n      '[object Uint8ClampedArray]',\n      '[object Int16Array]',\n      '[object Uint16Array]',\n      '[object Int32Array]',\n      '[object Uint32Array]',\n      '[object Float32Array]',\n      '[object Float64Array]'\n    ]\n\n    var isDataView = function(obj) {\n      return obj && DataView.prototype.isPrototypeOf(obj)\n    }\n\n    var isArrayBufferView = ArrayBuffer.isView || function(obj) {\n      return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n    }\n  }\n\n  function normalizeName(name) {\n    if (typeof name !== 'string') {\n      name = String(name)\n    }\n    if (/[^a-z0-9\\-#$%&'*+.\\^_`|~]/i.test(name)) {\n      throw new TypeError('Invalid character in header field name')\n    }\n    return name.toLowerCase()\n  }\n\n  function normalizeValue(value) {\n    if (typeof value !== 'string') {\n      value = String(value)\n    }\n    return value\n  }\n\n  // Build a destructive iterator for the value list\n  function iteratorFor(items) {\n    var iterator = {\n      next: function() {\n        var value = items.shift()\n        return {done: value === undefined, value: value}\n      }\n    }\n\n    if (support.iterable) {\n      iterator[Symbol.iterator] = function() {\n        return iterator\n      }\n    }\n\n    return iterator\n  }\n\n  function Headers(headers) {\n    this.map = {}\n\n    if (headers instanceof Headers) {\n      headers.forEach(function(value, name) {\n        this.append(name, value)\n      }, this)\n    } else if (Array.isArray(headers)) {\n      headers.forEach(function(header) {\n        this.append(header[0], header[1])\n      }, this)\n    } else if (headers) {\n      Object.getOwnPropertyNames(headers).forEach(function(name) {\n        this.append(name, headers[name])\n      }, this)\n    }\n  }\n\n  Headers.prototype.append = function(name, value) {\n    name = normalizeName(name)\n    value = normalizeValue(value)\n    var oldValue = this.map[name]\n    this.map[name] = oldValue ? oldValue+','+value : value\n  }\n\n  Headers.prototype['delete'] = function(name) {\n    delete this.map[normalizeName(name)]\n  }\n\n  Headers.prototype.get = function(name) {\n    name = normalizeName(name)\n    return this.has(name) ? this.map[name] : null\n  }\n\n  Headers.prototype.has = function(name) {\n    return this.map.hasOwnProperty(normalizeName(name))\n  }\n\n  Headers.prototype.set = function(name, value) {\n    this.map[normalizeName(name)] = normalizeValue(value)\n  }\n\n  Headers.prototype.forEach = function(callback, thisArg) {\n    for (var name in this.map) {\n      if (this.map.hasOwnProperty(name)) {\n        callback.call(thisArg, this.map[name], name, this)\n      }\n    }\n  }\n\n  Headers.prototype.keys = function() {\n    var items = []\n    this.forEach(function(value, name) { items.push(name) })\n    return iteratorFor(items)\n  }\n\n  Headers.prototype.values = function() {\n    var items = []\n    this.forEach(function(value) { items.push(value) })\n    return iteratorFor(items)\n  }\n\n  Headers.prototype.entries = function() {\n    var items = []\n    this.forEach(function(value, name) { items.push([name, value]) })\n    return iteratorFor(items)\n  }\n\n  if (support.iterable) {\n    Headers.prototype[Symbol.iterator] = Headers.prototype.entries\n  }\n\n  function consumed(body) {\n    if (body.bodyUsed) {\n      return Promise.reject(new TypeError('Already read'))\n    }\n    body.bodyUsed = true\n  }\n\n  function fileReaderReady(reader) {\n    return new Promise(function(resolve, reject) {\n      reader.onload = function() {\n        resolve(reader.result)\n      }\n      reader.onerror = function() {\n        reject(reader.error)\n      }\n    })\n  }\n\n  function readBlobAsArrayBuffer(blob) {\n    var reader = new FileReader()\n    var promise = fileReaderReady(reader)\n    reader.readAsArrayBuffer(blob)\n    return promise\n  }\n\n  function readBlobAsText(blob) {\n    var reader = new FileReader()\n    var promise = fileReaderReady(reader)\n    reader.readAsText(blob)\n    return promise\n  }\n\n  function readArrayBufferAsText(buf) {\n    var view = new Uint8Array(buf)\n    var chars = new Array(view.length)\n\n    for (var i = 0; i < view.length; i++) {\n      chars[i] = String.fromCharCode(view[i])\n    }\n    return chars.join('')\n  }\n\n  function bufferClone(buf) {\n    if (buf.slice) {\n      return buf.slice(0)\n    } else {\n      var view = new Uint8Array(buf.byteLength)\n      view.set(new Uint8Array(buf))\n      return view.buffer\n    }\n  }\n\n  function Body() {\n    this.bodyUsed = false\n\n    this._initBody = function(body) {\n      this._bodyInit = body\n      if (!body) {\n        this._bodyText = ''\n      } else if (typeof body === 'string') {\n        this._bodyText = body\n      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n        this._bodyBlob = body\n      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n        this._bodyFormData = body\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n        this._bodyText = body.toString()\n      } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n        this._bodyArrayBuffer = bufferClone(body.buffer)\n        // IE 10-11 can't handle a DataView body.\n        this._bodyInit = new Blob([this._bodyArrayBuffer])\n      } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n        this._bodyArrayBuffer = bufferClone(body)\n      } else {\n        throw new Error('unsupported BodyInit type')\n      }\n\n      if (!this.headers.get('content-type')) {\n        if (typeof body === 'string') {\n          this.headers.set('content-type', 'text/plain;charset=UTF-8')\n        } else if (this._bodyBlob && this._bodyBlob.type) {\n          this.headers.set('content-type', this._bodyBlob.type)\n        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n          this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8')\n        }\n      }\n    }\n\n    if (support.blob) {\n      this.blob = function() {\n        var rejected = consumed(this)\n        if (rejected) {\n          return rejected\n        }\n\n        if (this._bodyBlob) {\n          return Promise.resolve(this._bodyBlob)\n        } else if (this._bodyArrayBuffer) {\n          return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as blob')\n        } else {\n          return Promise.resolve(new Blob([this._bodyText]))\n        }\n      }\n\n      this.arrayBuffer = function() {\n        if (this._bodyArrayBuffer) {\n          return consumed(this) || Promise.resolve(this._bodyArrayBuffer)\n        } else {\n          return this.blob().then(readBlobAsArrayBuffer)\n        }\n      }\n    }\n\n    this.text = function() {\n      var rejected = consumed(this)\n      if (rejected) {\n        return rejected\n      }\n\n      if (this._bodyBlob) {\n        return readBlobAsText(this._bodyBlob)\n      } else if (this._bodyArrayBuffer) {\n        return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n      } else if (this._bodyFormData) {\n        throw new Error('could not read FormData body as text')\n      } else {\n        return Promise.resolve(this._bodyText)\n      }\n    }\n\n    if (support.formData) {\n      this.formData = function() {\n        return this.text().then(decode)\n      }\n    }\n\n    this.json = function() {\n      return this.text().then(JSON.parse)\n    }\n\n    return this\n  }\n\n  // HTTP methods whose capitalization should be normalized\n  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']\n\n  function normalizeMethod(method) {\n    var upcased = method.toUpperCase()\n    return (methods.indexOf(upcased) > -1) ? upcased : method\n  }\n\n  function Request(input, options) {\n    options = options || {}\n    var body = options.body\n\n    if (input instanceof Request) {\n      if (input.bodyUsed) {\n        throw new TypeError('Already read')\n      }\n      this.url = input.url\n      this.credentials = input.credentials\n      if (!options.headers) {\n        this.headers = new Headers(input.headers)\n      }\n      this.method = input.method\n      this.mode = input.mode\n      if (!body && input._bodyInit != null) {\n        body = input._bodyInit\n        input.bodyUsed = true\n      }\n    } else {\n      this.url = String(input)\n    }\n\n    this.credentials = options.credentials || this.credentials || 'omit'\n    if (options.headers || !this.headers) {\n      this.headers = new Headers(options.headers)\n    }\n    this.method = normalizeMethod(options.method || this.method || 'GET')\n    this.mode = options.mode || this.mode || null\n    this.referrer = null\n\n    if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n      throw new TypeError('Body not allowed for GET or HEAD requests')\n    }\n    this._initBody(body)\n  }\n\n  Request.prototype.clone = function() {\n    return new Request(this, { body: this._bodyInit })\n  }\n\n  function decode(body) {\n    var form = new FormData()\n    body.trim().split('&').forEach(function(bytes) {\n      if (bytes) {\n        var split = bytes.split('=')\n        var name = split.shift().replace(/\\+/g, ' ')\n        var value = split.join('=').replace(/\\+/g, ' ')\n        form.append(decodeURIComponent(name), decodeURIComponent(value))\n      }\n    })\n    return form\n  }\n\n  function parseHeaders(rawHeaders) {\n    var headers = new Headers()\n    rawHeaders.split(/\\r?\\n/).forEach(function(line) {\n      var parts = line.split(':')\n      var key = parts.shift().trim()\n      if (key) {\n        var value = parts.join(':').trim()\n        headers.append(key, value)\n      }\n    })\n    return headers\n  }\n\n  Body.call(Request.prototype)\n\n  function Response(bodyInit, options) {\n    if (!options) {\n      options = {}\n    }\n\n    this.type = 'default'\n    this.status = 'status' in options ? options.status : 200\n    this.ok = this.status >= 200 && this.status < 300\n    this.statusText = 'statusText' in options ? options.statusText : 'OK'\n    this.headers = new Headers(options.headers)\n    this.url = options.url || ''\n    this._initBody(bodyInit)\n  }\n\n  Body.call(Response.prototype)\n\n  Response.prototype.clone = function() {\n    return new Response(this._bodyInit, {\n      status: this.status,\n      statusText: this.statusText,\n      headers: new Headers(this.headers),\n      url: this.url\n    })\n  }\n\n  Response.error = function() {\n    var response = new Response(null, {status: 0, statusText: ''})\n    response.type = 'error'\n    return response\n  }\n\n  var redirectStatuses = [301, 302, 303, 307, 308]\n\n  Response.redirect = function(url, status) {\n    if (redirectStatuses.indexOf(status) === -1) {\n      throw new RangeError('Invalid status code')\n    }\n\n    return new Response(null, {status: status, headers: {location: url}})\n  }\n\n  self.Headers = Headers\n  self.Request = Request\n  self.Response = Response\n\n  self.fetch = function(input, init) {\n    return new Promise(function(resolve, reject) {\n      var request = new Request(input, init)\n      var xhr = new XMLHttpRequest()\n\n      xhr.onload = function() {\n        var options = {\n          status: xhr.status,\n          statusText: xhr.statusText,\n          headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n        }\n        options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL')\n        var body = 'response' in xhr ? xhr.response : xhr.responseText\n        resolve(new Response(body, options))\n      }\n\n      xhr.onerror = function() {\n        reject(new TypeError('Network request failed'))\n      }\n\n      xhr.ontimeout = function() {\n        reject(new TypeError('Network request failed'))\n      }\n\n      xhr.open(request.method, request.url, true)\n\n      if (request.credentials === 'include') {\n        xhr.withCredentials = true\n      }\n\n      if ('responseType' in xhr && support.blob) {\n        xhr.responseType = 'blob'\n      }\n\n      request.headers.forEach(function(value, name) {\n        xhr.setRequestHeader(name, value)\n      })\n\n      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)\n    })\n  }\n  self.fetch.polyfill = true\n})(typeof self !== 'undefined' ? self : this);\n","import '../../polyfills/promise';\r\nimport 'whatwg-fetch';\r\nimport pngsList from './iconsList';\r\n\r\n\r\nconst placeCharacters = (map, assetsPath) => {\r\n\r\n\t// DISABLED for now\r\n\treturn true;\r\n\r\n\tconst airportsMarkers = [];\r\n\tconst icons = [];\r\n\tconst localMap = map;\r\n\tconst pngs = Object.keys(pngsList);\r\n\tlet j = 0;\r\n\t\r\n\r\n\tfetch(\"./datasets/airports.json\")\r\n\t\t.then((response) => response.json())\r\n\t\t.then((airports) => {\t\t\t\t\t\r\n\t\t\tairports.map((airport) => {\r\n\t\t\t\tif (j === pngs.length) {j = 0};\r\n\t\t\t\tconst randKey = Math.floor((Math.random()*1000)/10 * (pngs.length/100));\r\n\t\t\t\tconst img = pngs[randKey]||pngs[0];\r\n\t\t\t\tconst imgSize = pngsList[img];\r\n\r\n\t\t\t\t// Character object \r\n\t\t\t\tlet character = {\r\n\t\t\t\t\tposition: new google.maps.LatLng(airport.latitude, airport.longitude),\r\n\t\t\t\t\ticon: {\r\n\t\t\t\t\t\turl: `${assetsPath}${img}.png`,\r\n\t\t\t\t\t\tsize: new google.maps.Size(imgSize[0], imgSize[1]),\r\n\t\t\t\t\t\torigin: new google.maps.Point(0, 0),\r\n\t\t\t\t\t\tanchor: new google.maps.Point(17, 34),\r\n\t\t\t\t\t\tscaledSize: new google.maps.Size(imgSize[0], imgSize[1]),\r\n\t\t\t\t\t},\r\n\t\t\t\t}\r\n\t\t\t\t// Add a marker for each character\r\n\t\t\t\tairportsMarkers.push(\tnew google.maps.Marker({\r\n\t\t\t\t\t\tposition: character.position,\r\n\t\t\t\t\t\tmap: localMap,\r\n\t\t\t\t\t\ticon: character.icon,\r\n\t\t\t\t\t\tvisible: false\r\n\t\t\t\t\t})\r\n\t\t\t\t);\t\t\t\r\n\t\t\t\ticons.push(character);\r\n\t\t\t\tj++;\r\n\t\t\t});\r\n\r\n\t\t\t// Shuffle the markers\r\n\t\t\tshuffle( airportsMarkers );\r\n\r\n\t\t\t// Initial visibility\r\n\t\t\tsetVisibleMarkers(localMap.getZoom());\r\n\r\n\t\t}).catch((err) => {\r\n\t\t\tconsole.log(err);\r\n\t});\r\n\r\n\t//\tChange markers on zoom\r\n\tgoogle.maps.event.addListener(localMap, 'zoom_changed', function() {\r\n\t\tsetVisibleMarkers(localMap.getZoom());\r\n\t\tlet zoom = localMap.getZoom();\r\n\t});\r\n\r\n\tfunction setVisibleMarkers( zoom ){\r\n\t\tconst maxZoom = 8;\r\n\t\tconst max = airportsMarkers.length * (zoom/maxZoom/20);\r\n\t\tlet y = 0;\r\n\t\tairportsMarkers.map((marker, i) => {\r\n\t\t\tmarker.setVisible(i < max);\r\n\t\t\ti < max && (y++);\r\n\t\t});\r\n\t\tconsole.log(`${y} markers display at ${zoom} with max at ${max}`);\r\n\t}\r\n}\r\n\r\nexport default placeCharacters;\r\n\r\n/**\r\n * Shuffles array in place. ES6 version\r\n * @param {Array} a items The array containing the items.\r\n */\r\nfunction shuffle(a) {\r\n    for (let i = a.length; i; i--) {\r\n        let j = Math.floor(Math.random() * i);\r\n        [a[i - 1], a[j]] = [a[j], a[i - 1]];\r\n    }\r\n}\r\n","const checkAssetsPath = (assetsPath) => {\r\n\t \r\n\tif (RegExp('^(/[^/ ]*)+/$').test(assetsPath)) {\r\n\t\treturn true;\r\n\t}\r\n\telse {\r\n\t\tconsole.error('Please provide the icons directory as in \"/path/to/icons/\"')\r\n\t}\r\n};\r\nexport default checkAssetsPath;","/*eslint-disable */\r\nimport '../../../styles/main.v2.scss';\r\n\r\nimport createSearchBox from '../searchBox/createSearchBox';\r\nimport searchBox from '../searchBox/searchBox';\r\nimport promoAreaLogged from '../promoArea/promoAreaLogged';\r\nimport promoArea from '../promoArea/promoArea';\r\nimport fetchData from '../fetchData/fetchData';\r\nimport createMap from './createMap';\r\nimport defineCenter from './defineCenter';\r\nimport placeCharacters from '../characters/placeCharacters';\r\nimport checkAssetsPath from '../characters/checkAssetsPath';\r\nimport mapStyles, {mapDetailStyles} from './mapStyles';\r\n\r\n\r\nimport {\r\n\tgetIcon,\r\n\tsetIcon,\r\n\taddCenterToOptions\r\n} from './options';\r\n\r\nconst $ = window.jQuery;\r\n\r\nif(!$){\r\n\tthrow 'jQuery is required for this map plugin';\r\n}\r\n\r\nclass Map {\r\n\tconstructor( settings ){\r\n\t\t$.extend(this, settings);\r\n\t\tthis.markers = this.markers || [];\r\n\t\tthis.placeMarkers = this.placeMarkers || [];\r\n\t\tthis.init();\r\n\t}\r\n\r\n\tinit(){\r\n\t\tthis.listeners = [];\r\n\t\tthis.wrapper = this.domElement;\r\n\t\tthis.map = createMap(this.wrapper);\r\n\t\tthis.sBox = createSearchBox(this.map, this.domElement);\r\n\t\tthis.avatarURL = this.avatarURL || defineURL('https://github.com/identicons/', '.png');\r\n\r\n\t\tpanelClosedOnLoad(this.domElement);\r\n\t\tbindEvents( this.domElement, this.map );\r\n\t\tbindClickEvent( this.domElement, this.data, this.listeners );\r\n\r\n\t\t// Other initiliasation\r\n\t\tthis.initFetchData();\r\n\t\tthis.initSearchBox();\r\n\t\tthis.initPromoAreas();\r\n\t\tthis.placeCharacters();\r\n\t\tthis.initMapFullDisplay();\r\n\t\tthis.initMapGenericBehaviour();\r\n\t}\r\n\r\n\tinitFetchData(){\r\n\t\tfetchData(\r\n\t\t\tthis.map, \r\n\t\t\tthis.data, \r\n\t\t\tthis.markers, \r\n\t\t\tthis.avatarURL, \r\n\t\t\tthis.domElement,\r\n\t\t\tthis.assetsPath\r\n\t\t);\r\n\t}\r\n\r\n\tinitSearchBox(){\r\n\t\tsearchBox(\r\n\t\t\tthis.map, \r\n\t\t\tthis.places, \r\n\t\t\tthis.sBox, \r\n\t\t\tthis.placeMarkers, \r\n\t\t\tthis.getIcon, \r\n\t\t\tthis.setIcon\r\n\t\t);\r\n\t}\r\n\r\n\tinitPromoAreas(){\r\n\t\t// Render promo area\r\n\t\tif(this.isLoggedIn){\r\n\t\t\tpromoAreaLogged(() => {\r\n\t\t\t\tconsole.log('change your location clicked')\r\n\t\t\t}, this.assetsPath)\r\n\t\t} else {\r\n\t\t\tpromoArea(() => {\r\n\t\t\t\tconsole.log('Add your marker clicked!')\r\n\t\t\t}, this.markers.length, this.assetsPath)\r\n\t\t}\r\n\r\n\t\t// Display air balloon\r\n\t\tairBalloon(this.domElement, this.isLoggedIn, this.assetsPath);\r\n\t}\r\n\r\n\tplaceCharacters(){\r\n\t\t// Add characters\r\n\t\tsetTimeout(() => {\r\n\t\t\tif (checkAssetsPath(this.assetsPath)) {\r\n\t\t\t\tplaceCharacters(this.map, this.assetsPath);\r\n\t\t\t}\r\n\t\t}, 100 );\r\n\t}\r\n\r\n\tinitMapFullDisplay(){\r\n\t\t// Show whole map on click\r\n\t\tshowMap(this.domElement, this.map);\r\n\t}\r\n\r\n\tinitMapGenericBehaviour(){\r\n\t\t// Open panel on zoom\r\n\t\tgoogle.maps.event.addListenerOnce(this.map, 'zoom_changed', function () {\r\n\t\t\tconst $panel = $(this.domElement).find('.shiftmap-map-clusterise-user-panel');\r\n\t\t\t$panel.removeClass('default')\r\n\t\t});\r\n\t}\r\n\r\n\t// Returns an object of public events\r\n\t// Used for manipulating the map after load\r\n\t// Or listening to events\r\n\tpublic(){\r\n\t\tconst self = this;\r\n\r\n\t\treturn {\r\n\t\t\tenablePlotLocationMode: () => {\r\n\t\t\t\tenablePlotLocationMode(this.domElement);\r\n\t\t\t},\r\n\t\t\tsetWidthHeight: ( width, height ) => {\r\n\t\t\t\tsetWidthHeight( width, height, this.map );\r\n\t\t\t},\r\n\t\t\tsetMapLocation: ( lat, lng ) => {\r\n\t\t\t\tchangeMapLocation( lat, lng, this.map );\r\n\t\t\t},\r\n\t\t\tonMapReady : ( callback ) => {\r\n\t\t\t\tonMapReady( callback, this.map );\r\n\t\t\t},\r\n\t\t\tonAirBalloonClick: ( callback ) => {\r\n\t\t\t\tonAirBalloonClick(this.domElement, callback);\r\n\t\t\t},\r\n\t\t\tonMapChangeLocation: ( callback ) => {\r\n\t\t\t\tonMapChangeLocation( callback, this.map );\r\n\t\t\t},\r\n\t\t\tonPlotLocation: ( callback ) => {\r\n\t\t\t\tonPlotLocation(this.map, callback );\r\n\t\t\t},\r\n\t\t\tonClickUser : ( callback ) => {\r\n\t\t\t\tonClickUser( callback, null, this.listeners);\r\n\t\t\t},\r\n\t\t\tinsertMarker: ( lat, lng, imgURL, clickEvent) => {\r\n\t\t\t\tinsertMarker(lat, lng, imgURL, clickEvent, this.map);\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n}\r\n\r\nconst initialize = (settings) => {\r\n\tconst map = new Map(settings);\r\n\treturn map.public();\r\n};\r\n\r\n\r\n// Plot location listener\r\nconst onPlotLocation = (map, callback) => {\r\n\tgoogle.maps.event.addListener(map, 'shiftms_plotted_location', callback);\r\n};\r\n\r\n\r\n// Air Balloon\r\nconst airBalloon = (domElement, logged, assetsPath) => {\r\n\tlet balloon = $(domElement).find('.shiftmap-airballoon-image');\r\n\tlet dismiss = $(domElement).find('.balloon-dismiss');\r\n\t$(dismiss).click(( e ) => {\r\n\t\t$(balloon).remove();\r\n\t});\r\n\tif (logged) {\r\n\t\tballoon.remove();\r\n\t\t//balloon.attr('src', `${assetsPath}promo/map-hot-air-balloon.png`);\r\n\t}\r\n\telse { balloon.attr('src', `${assetsPath}promo/map-hot-air-balloon.png?v=1`); }\r\n};\r\n\r\n\r\n// Balloon click listener\r\nconst onAirBalloonClick = (domElement, callback) => {\r\n\tconst balloon = $(domElement).find('.shiftmap-airballoon-image');\r\n\tballoon.click( callback );\r\n}\r\n\r\n// Insert markers after map is loaded\r\nconst insertMarker = (lat, lng, imgURL, clickEvent, map) => {\r\n\tlat = lat || null;\r\n\tlng = lng || null;\r\n\timgURL = imgURL.toString() || null;\r\n\tclickEvent = clickEvent || function(){};\r\n\r\n\tif (typeof clickEvent !== 'function') {\r\n\t\tthrow 'Click event must be a function!';\r\n\t}\r\n\r\n\tif (typeof lat !== 'number' || typeof lng !== 'number') {\r\n\t\tthrow 'Coordinates must be numbers!';\r\n\t}\r\n\r\n\tvar img = new Image();\r\n\timg.onload = () => {\r\n\t\tconst imgWidth = Math.abs(img.width/2) || null;\r\n\t\tconst imgHeight = Math.abs(img.height/2) || null;\r\n\r\n\t\tgoogle.maps.event.addListener(map, 'idle', function() {\r\n\t\t\tconst location = new google.maps.LatLng(parseFloat(lat).toFixed(6), parseFloat(lng).toFixed(6));\r\n\t\t\tconst icon = {\r\n\t\t\t\turl: `${imgURL}`,\r\n\t\t\t\tsize: new google.maps.Size(imgWidth, imgHeight),\r\n\t\t\t\torigin: new google.maps.Point(0, 0),\r\n\t\t\t\tanchor: new google.maps.Point(imgWidth/2, imgHeight),\r\n\t\t\t\tscaledSize: new google.maps.Size(imgWidth, imgHeight),\r\n\t\t\t};\r\n\t\t\tconst marker = new google.maps.Marker({\r\n\t\t\t\tposition: location,\r\n\t\t\t\ticon: icon,\r\n\t\t\t\tmap: map,\r\n\t\t\t\t// optimized: false,\r\n\t\t\t\t// zindex: 0,\r\n\t\t\t\turl: '',\r\n\t\t\t}).addListener('click', function(){\r\n\t\t\t\tclickEvent( marker, imgURL );\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t}\r\n\r\n\timg.src = imgURL;\r\n};\r\n\r\n\r\n// Panel closed on page load\r\nconst panelClosedOnLoad = (domElement) => {\r\n\tconst $panel = $(domElement).find('.shiftmap-map-clusterise-user-panel');\r\n\t\t$panel.toggleClass('default');\r\n};\r\n\r\n\r\n// Move map to specified coordinates , dk why i built this though\r\nconst changeMapLocation = (lat, lng, map) => {\r\n\tlet location = defineCenter(lat, lng);\r\n\tmap.panTo(location);\r\n};\r\n\r\n\r\n// Detects when map is loaded\r\nconst onMapReady = (callback, map) => {\r\n\tif (typeof callback === 'function') {\r\n\t\tgoogle.maps.event.addListenerOnce(map, 'idle', callback);\r\n\t}\r\n\telse {\r\n\t\tconsole.error('provide a callback function');\r\n\t}\r\n};\r\n\r\n\r\n// Fires event when map changes locations\r\nconst onMapChangeLocation = (callback, map) => {\r\n\tif (typeof callback === 'function') {\r\n\t\tgoogle.maps.event.addListener(map, 'idle', callback);\r\n\t}\r\n\telse {\r\n\t\tconsole.error('provide a callback function');\r\n\t}\r\n};\r\n\r\n\r\n// Builds assets URL in acceptable format\r\nconst defineURL = (url, imgFormat) => {\r\n\treturn [url.toString(), imgFormat.toString()];\r\n};\r\n\r\n\r\n// Display zoomed out map \r\nconst showMap = (domElement, map) => {\r\n\tconst showMapButton = $(domElement).find('.shiftmap-showmap');\r\n\tconst topLeft = new google.maps.LatLng(68.870136, -160.789405);\r\n\tconst bottomRight = new google.maps.LatLng(-44.879507, 178.880419)\r\n\tconst bounds = new google.maps.LatLngBounds(topLeft, bottomRight);\r\n\t\r\n\tconst onClick = () => {\r\n\t\tshowMapButton.click(function() {\r\n\t\t\tmap.fitBounds(bounds)\r\n\t\t});\r\n\t}\r\n\tgoogle.maps.event.addListener(map, 'idle', onClick);\r\n};\r\n\r\n\r\nconst bindEvents = ( domElement, map ) => {\r\n\tconst $panel = $(domElement).find('.shiftmap-map-clusterise-user-panel');\r\n\r\n\t$panel.find('.shiftmap-map-toggle-panel').click(function(){\r\n\t\t$(this).removeClass('alert-user');\r\n\t\tif ($panel.hasClass('default')) {\r\n\t\t\t$panel.removeClass('default')\r\n\t\t}\r\n\t\telse {\r\n\t\t\t$panel.toggleClass('closed');\r\n\t\t}\r\n\t});\r\n\r\n\t//\tChange markers on zoom\r\n\tgoogle.maps.event.addListener(map, 'zoom_changed', function() {\r\n\t\tlet zoom = map.getZoom();\r\n\t\tif( zoom > 7 ){\r\n\t\t\tmap.setOptions({styles: mapDetailStyles});\r\n\t\t} else {\t\t\t\r\n\t\t\tmap.setOptions({styles: mapStyles});\r\n\t\t}\r\n\t});\r\n\r\n\t$(domElement).on('openpanel', () => {\r\n\t\t$panel.removeClass('closed');\r\n\t});\r\n\r\n\tgoogle.maps.event.addListenerOnce(map, 'idle', function(){\r\n\t   geolocationAPI(map);\r\n\t});\r\n\r\n};\r\n\r\n\r\n// Define map dimensions\r\nconst setWidthHeight = (width, height, map) => {\r\n\t$('.shiftmap-wrapper').width(width).height(height);\r\n\t$('.shiftmap-map').width(width).height(height);\r\n\tgoogle.maps.event.trigger(map, 'resize');\t\r\n\tgoogle.maps.event.addListenerOnce(map, 'idle', function() {\r\n\t\tgoogle.maps.event.trigger(map, 'resize'); \r\n\t});\r\n};\r\n\r\n\r\nconst onClickUser = (fn, args, listeners ) => {\r\n\tif( fn ){\r\n\t\tlisteners.push(fn);\r\n\t} else {\r\n\t\tlisteners.map((e) => e(args))\r\n\t}\r\n}\r\n\r\n\r\nconst bindClickEvent = ( domElement, data, listeners ) => {\r\n\t$(domElement).on('click', '[data-clickuser]', function(){\r\n\t\tconst id = $(this).data('clickuser');\r\n\t\tlet find;\r\n\t\tdata.map((e) => {\r\n\t\t\tif( e.user_id === id ){\r\n\t\t\t\tfind = e;\r\n\t\t\t}\r\n\t\t});\r\n\t\tlisteners.map((fn) => fn(find));\r\n\t});\r\n}\r\n\r\n\r\nconst geolocationAPI = ( map ) => {\r\n\tif (navigator.geolocation) {\r\n\t\tnavigator.geolocation.getCurrentPosition(function (position) {\r\n\t\t\tconst initialLocation = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);\r\n\t\t\tmap.setCenter(initialLocation);\r\n\t\t\tmap.setZoom(5);\r\n\t\t});\r\n\t}\r\n};\r\n\r\nconst enablePlotLocationMode = (wrapper) => {\r\n\t$(wrapper).find('.shiftmap-promo-area').addClass('in');\r\n\t$(wrapper).find('.shiftmap-map-clusterise-user-panel').removeClass('default closed');\r\n}\r\n\r\n\r\nexport {\r\n\tinitialize\r\n};\r\n\r\n/*\r\n\tinsertMarker,\r\n\tsetWidthHeight,\r\n\tonMapReady,\r\n\tonMapChangeLocation,\r\n\tdefineURL,\r\n\tchangeMapLocation,\r\n\tonClickUser,\r\n\tonPlotLocation,\r\n\tonAirBalloonClick,\r\n\tenablePlotLocationMode\r\n*/"],"names":["$","window","jQuery","createSearchBox","map","mapWrapper","localMap","$input","find","input","get","searchBox","google","maps","places","SearchBox","Symbol","id","width","height","fill","marker_svg","btoa","p","land","water","mapStyles","mapDetailStyles","defineCenter","lat","lng","LatLng","parseFloat","toFixed","options","clusterOptions","getMapOptions","extend","MapTypeId","ROADMAP","clusterStyles","getClusterOptions","getIconPlace","Size","Point","sBox","placeMarkers","getIcon","setIcon","addListener","setBounds","getBounds","isPlotSearch","length","getPlaces","forEach","marker","setMap","bounds","LatLngBounds","place","geometry","log","Marker","name","location","push","viewport","union","fitBounds","event","addListenerOnce","infoWindow","createInfoWindow","setZoom","html","confirmLocationContent","infowindow","InfoWindow","setContent","click","trigger","close","removeClass","open","promoArea","insertMarker","assetsPath","promoHtml","replace","userPanel","prepend","addClass","one","focus","numUsers","definition","module","ie","v","el","document","createElement","all","innerHTML","documentMode","is_mac","navigator","platform","toLowerCase","indexOf","Clusterize","data","self","defaults","i","option","elems","elem","getElementById","Error","content_elem","hasAttribute","setAttribute","rows","isArray","fetchMarkup","cache","scroll_top","scroll_elem","scrollTop","insertToDOM","last_cluster","scroll_debounce","pointer_events_set","scrollEv","style","pointerEvents","setTimeout","getClusterNum","callbacks","scrollingProgress","getScrollProgress","resize_debounce","resizeEv","refresh","destroy","clean","generateEmptyRow","join","force","getRowsHeight","update","new_rows","item_height","clear","getRowsAmount","add","where","_new_rows","concat","append","prototype","rows_nodes","getChildNodes","shift","outerHTML","opts","content_tag","tagName","tag","match","children","prev_item_height","cluster_height","nodes","node","Math","floor","offsetHeight","getStyle","parseInt","marginTop","marginBottom","max","block_height","rows_in_block","rows_in_cluster","blocks_in_cluster","show_no_data_row","empty_row","no_data_content","createTextNode","no_data_text","td","className","no_data_class","colSpan","appendChild","cluster_num","rows_len","items_start","items_end","top_offset","bottom_offset","this_cluster_rows","rows_above","class_name","clusterize_prefix","exploreEnvironment","generate","this_cluster_content_changed","checkChanges","top_offset_changed","only_bottom_offset_changed","layout","keep_parity","renderExtraTag","clusterWillChange","clusterChanged","lastChild","div","last","removeChild","firstChild","child_nodes","ii","type","value","changed","on","evt","element","fnc","addEventListener","attachEvent","off","removeEventListener","detachEvent","arr","Object","toString","call","prop","getComputedStyle","currentStyle","zoomingOnSingle","buildList","clusterize","listArray","markers","domElement","user","contains","getPosition","userID","url","userName","showUserInfo","city","country","active","clickEventBound","addDomListener","getZoom","setCenter","checkData","dataset","stringify","err","error","getRandom","min","random","MarkerClusterer","opt_markers","opt_options","OverlayView","map_","markers_","clusters_","sizes","styles_","ready_","gridSize_","minClusterSize_","maxZoom_","imagePath_","MARKER_CLUSTER_IMAGE_PATH_","imageExtension_","MARKER_CLUSTER_IMAGE_EXTENSION_","zoomOnClick_","undefined","averageCenter_","setupStyles_","prevZoom_","that","zoom","minZoom","maxZoom","mapTypes","getMapTypeId","resetViewport","redraw","keys","addMarkers","obj1","obj2","object","property","apply","onAdd","setReady_","draw","size","fitMapToMarkers","getMarkers","setStyles","styles","getStyles","isZoomOnClick","isAverageCenter","getTotalMarkers","setMaxZoom","getMaxZoom","calculator_","numStyles","index","count","dv","setCalculator","calculator","getCalculator","opt_nodraw","pushMarkerTo_","isAdded","repaint","addMarker","removeMarker_","m","splice","removeMarker","removed","removeMarkers","markersCopy","slice","r","ready","createClusters_","getTotalClusters","getMap","getGridSize","setGridSize","getMinClusterSize","setMinClusterSize","getExtendedBounds","projection","getProjection","tr","getNorthEast","bl","getSouthWest","trPix","fromLatLngToDivPixel","x","y","blPix","ne","fromDivPixelToLatLng","sw","isMarkerInBounds_","clearMarkers","opt_hide","cluster","remove","oldClusters","distanceBetweenPoints_","p1","p2","R","dLat","PI","dLon","a","sin","cos","c","atan2","sqrt","d","addToClosestCluster_","distance","clusterToAddTo","pos","center","getCenter","isMarkerInClusterBounds","Cluster","mapBounds","markerClusterer","markerClusterer_","center_","bounds_","clusterIcon_","ClusterIcon","isMarkerAlreadyAdded","calculateBounds_","l","len","updateIcon","getMarkerClusterer","getSize","mz","hide","sums","setSums","show","opt_padding","padding_","cluster_","div_","sums_","visible_","triggerClusterClick","panes","getPanes","getPosFromLatLng_","cssText","createCss","text","overlayMouseTarget","classList","latlng","width_","height_","top","left","display","onRemove","parentNode","text_","index_","useStyle","url_","textColor_","anchor_","textSize_","backgroundPosition_","backgroundPosition","_typeof","txtColor","txtSize","o","result","hasOwnProperty","pngsList","mapDragging","fetchData","avatarURL","j","pngs","maxZoomLevel","scrollElement","contentElement","markerPosition","latitude","longitude","warn","user_id","randKey","img","imgSize","icon","full_name","avatar","markerCluster","bindListeners","createMap","$wrapper","template","$map","opt","Map","root","setTimeoutFunc","noop","bind","fn","thisArg","arguments","Promise","TypeError","_state","_handled","_value","_deferreds","handle","deferred","_immediateFn","cb","onFulfilled","onRejected","resolve","reject","promise","ret","e","newValue","then","finale","_unhandledRejectionFn","Handler","doResolve","done","reason","ex","prom","constructor","args","Array","remaining","res","val","race","values","setImmediate","console","_setImmediateFn","_setUnhandledRejectionFn","exports","this","fetch","support","Blob","arrayBuffer","viewClasses","isDataView","obj","DataView","isPrototypeOf","isArrayBufferView","ArrayBuffer","isView","normalizeName","String","test","normalizeValue","iteratorFor","items","iterator","iterable","Headers","headers","header","getOwnPropertyNames","oldValue","has","set","callback","entries","consumed","body","bodyUsed","fileReaderReady","reader","onload","onerror","readBlobAsArrayBuffer","blob","FileReader","readAsArrayBuffer","readBlobAsText","readAsText","readArrayBufferAsText","buf","view","Uint8Array","chars","fromCharCode","bufferClone","byteLength","buffer","Body","_initBody","_bodyInit","_bodyText","_bodyBlob","formData","FormData","_bodyFormData","searchParams","URLSearchParams","_bodyArrayBuffer","rejected","decode","json","JSON","parse","methods","normalizeMethod","method","upcased","toUpperCase","Request","credentials","mode","referrer","clone","form","trim","split","bytes","decodeURIComponent","parseHeaders","rawHeaders","line","parts","key","Response","bodyInit","status","ok","statusText","response","redirectStatuses","redirect","RangeError","init","request","xhr","XMLHttpRequest","getAllResponseHeaders","responseURL","responseText","ontimeout","withCredentials","responseType","setRequestHeader","send","polyfill","placeCharacters","airportsMarkers","icons","airports","airport","character","position","catch","setVisibleMarkers","setVisible","shuffle","checkAssetsPath","RegExp","settings","listeners","wrapper","defineURL","initFetchData","initSearchBox","initPromoAreas","initMapFullDisplay","initMapGenericBehaviour","isLoggedIn","$panel","public","imgURL","clickEvent","initialize","onPlotLocation","airBalloon","logged","balloon","dismiss","attr","onAirBalloonClick","Image","imgWidth","abs","imgHeight","src","panelClosedOnLoad","toggleClass","changeMapLocation","panTo","onMapReady","onMapChangeLocation","imgFormat","showMap","showMapButton","topLeft","bottomRight","onClick","bindEvents","hasClass","setOptions","setWidthHeight","onClickUser","bindClickEvent","geolocationAPI","geolocation","getCurrentPosition","initialLocation","coords","enablePlotLocationMode"],"mappings":"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"}